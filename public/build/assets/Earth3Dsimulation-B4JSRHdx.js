import{C as Hr,V as R,M as vt,T as Tt,Q as Jt,S as Un,a as ae,R as Br,P as Kr,b as Ye,c as Xr,d as Ki,e as Ss,L as Wr,f as Yt,F as Es,g as Ce,h as Ee,i as Ue,j as Lt,k as Yr,l as vs,D as As,m as Se,I as qr,n as $r,O as mn,o as _n,p as Zr,B as Li,q as Qr,r as Ps,N as Jr,s as eo,t as to,u as Xi,v as Rs,w as Wi,x as io,y as no,z as Os,A as Ci,E as Ei,G as gn,H as Ls,J as He,K as so,U as ai,W as ro,X as ut,Y as oo,Z as vi,_ as ao,$ as Cs,a0 as di,a1 as Ds,a2 as lo,a3 as co,a4 as ho,a5 as uo,a6 as fo,a7 as Is,a8 as po,a9 as zn,aa as Gn,ab as jn,ac as Vn,ad as Hn,ae as Yi,af as mo,ag as _o,ah as go,ai as Bn,aj as wo,ak as yo,al as bo,am as qt,an as Kn,ao as To,ap as Xn,aq as Ns,ar as xo,as as Mo,at as So}from"./orbitalCalculation-psKLm8rd.js";import{E as Y,M as qi,S as X,J as Eo,a as _i,D as Q,g as vo,b as Wn}from"./parametersimulation-3a_QzFdB.js";const Yn={type:"change"},wn={type:"start"},ks={type:"end"},hi=new Br,qn=new Kr,Ao=Math.cos(70*Ye.DEG2RAD),W=new R,oe=2*Math.PI,C={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Di=1e-6;class Po extends Hr{constructor(e,t=null){super(e,t),this.state=C.NONE,this.target=new R,this.cursor=new R,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:vt.ROTATE,MIDDLE:vt.DOLLY,RIGHT:vt.PAN},this.touches={ONE:Tt.ROTATE,TWO:Tt.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new R,this._lastQuaternion=new Jt,this._lastTargetPosition=new R,this._quat=new Jt().setFromUnitVectors(e.up,new R(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Un,this._sphericalDelta=new Un,this._scale=1,this._panOffset=new R,this._rotateStart=new ae,this._rotateEnd=new ae,this._rotateDelta=new ae,this._panStart=new ae,this._panEnd=new ae,this._panDelta=new ae,this._dollyStart=new ae,this._dollyEnd=new ae,this._dollyDelta=new ae,this._dollyDirection=new R,this._mouse=new ae,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Oo.bind(this),this._onPointerDown=Ro.bind(this),this._onPointerUp=Lo.bind(this),this._onContextMenu=Uo.bind(this),this._onMouseWheel=Io.bind(this),this._onKeyDown=No.bind(this),this._onTouchStart=ko.bind(this),this._onTouchMove=Fo.bind(this),this._onMouseDown=Co.bind(this),this._onMouseMove=Do.bind(this),this._interceptControlDown=zo.bind(this),this._interceptControlUp=Go.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Yn),this.update(),this.state=C.NONE}update(e=null){const t=this.object.position;W.copy(t).sub(this.target),W.applyQuaternion(this._quat),this._spherical.setFromVector3(W),this.autoRotate&&this.state===C.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,n=this.maxAzimuthAngle;isFinite(i)&&isFinite(n)&&(i<-Math.PI?i+=oe:i>Math.PI&&(i-=oe),n<-Math.PI?n+=oe:n>Math.PI&&(n-=oe),i<=n?this._spherical.theta=Math.max(i,Math.min(n,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+n)/2?Math.max(i,this._spherical.theta):Math.min(n,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=r!=this._spherical.radius}if(W.setFromSpherical(this._spherical),W.applyQuaternion(this._quatInverse),t.copy(this.target).add(W),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const a=W.length();r=this._clampDistance(a*this._scale);const l=a-r;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new R(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const c=new R(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(a),this.object.updateMatrixWorld(),r=W.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(hi.origin.copy(this.object.position),hi.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(hi.direction))<Ao?this.object.lookAt(this.target):(qn.setFromNormalAndCoplanarPoint(this.object.up,this.target),hi.intersectPlane(qn,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>Di||8*(1-this._lastQuaternion.dot(this.object.quaternion))>Di||this._lastTargetPosition.distanceToSquared(this.target)>Di?(this.dispatchEvent(Yn),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?oe/60*this.autoRotateSpeed*e:oe/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){W.setFromMatrixColumn(t,0),W.multiplyScalar(-e),this._panOffset.add(W)}_panUp(e,t){this.screenSpacePanning===!0?W.setFromMatrixColumn(t,1):(W.setFromMatrixColumn(t,0),W.crossVectors(this.object.up,W)),W.multiplyScalar(e),this._panOffset.add(W)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){const n=this.object.position;W.copy(n).sub(this.target);let s=W.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),n=e-i.left,s=t-i.top,r=i.width,a=i.height;this._mouse.x=n/r*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(oe*this._rotateDelta.x/t.clientHeight),this._rotateUp(oe*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(oe*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-oe*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(oe*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-oe*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._rotateStart.set(i,n)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._panStart.set(i,n)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,n=e.pageY-t.y,s=Math.sqrt(i*i+n*n);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),n=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateEnd.set(n,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(oe*this._rotateDelta.x/t.clientHeight),this._rotateUp(oe*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this._panEnd.set(i,n)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,n=e.pageY-t.y,s=Math.sqrt(i*i+n*n);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new ae,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function Ro(o){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(o.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(o)&&(this._addPointer(o),o.pointerType==="touch"?this._onTouchStart(o):this._onMouseDown(o)))}function Oo(o){this.enabled!==!1&&(o.pointerType==="touch"?this._onTouchMove(o):this._onMouseMove(o))}function Lo(o){switch(this._removePointer(o),this._pointers.length){case 0:this.domElement.releasePointerCapture(o.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(ks),this.state=C.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function Co(o){let e;switch(o.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case vt.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(o),this.state=C.DOLLY;break;case vt.ROTATE:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=C.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=C.ROTATE}break;case vt.PAN:if(o.ctrlKey||o.metaKey||o.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(o),this.state=C.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(o),this.state=C.PAN}break;default:this.state=C.NONE}this.state!==C.NONE&&this.dispatchEvent(wn)}function Do(o){switch(this.state){case C.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(o);break;case C.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(o);break;case C.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(o);break}}function Io(o){this.enabled===!1||this.enableZoom===!1||this.state!==C.NONE||(o.preventDefault(),this.dispatchEvent(wn),this._handleMouseWheel(this._customWheelEvent(o)),this.dispatchEvent(ks))}function No(o){this.enabled!==!1&&this._handleKeyDown(o)}function ko(o){switch(this._trackPointer(o),this._pointers.length){case 1:switch(this.touches.ONE){case Tt.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(o),this.state=C.TOUCH_ROTATE;break;case Tt.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(o),this.state=C.TOUCH_PAN;break;default:this.state=C.NONE}break;case 2:switch(this.touches.TWO){case Tt.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(o),this.state=C.TOUCH_DOLLY_PAN;break;case Tt.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(o),this.state=C.TOUCH_DOLLY_ROTATE;break;default:this.state=C.NONE}break;default:this.state=C.NONE}this.state!==C.NONE&&this.dispatchEvent(wn)}function Fo(o){switch(this._trackPointer(o),this.state){case C.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(o),this.update();break;case C.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(o),this.update();break;case C.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(o),this.update();break;case C.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(o),this.update();break;default:this.state=C.NONE}}function Uo(o){this.enabled!==!1&&o.preventDefault()}function zo(o){o.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Go(o){o.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function $n(o,e){if(e===Xr)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(e===Ki||e===Ss){let t=o.getIndex();if(t===null){const r=[],a=o.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)r.push(l);o.setIndex(r),t=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}const i=t.count-2,n=[];if(e===Ki)for(let r=1;r<=i;r++)n.push(t.getX(0)),n.push(t.getX(r)),n.push(t.getX(r+1));else for(let r=0;r<i;r++)r%2===0?(n.push(t.getX(r)),n.push(t.getX(r+1)),n.push(t.getX(r+2))):(n.push(t.getX(r+2)),n.push(t.getX(r+1)),n.push(t.getX(r)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=o.clone();return s.setIndex(n),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),o}class jo extends Wr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new Xo(t)}),this.register(function(t){return new Wo(t)}),this.register(function(t){return new ia(t)}),this.register(function(t){return new na(t)}),this.register(function(t){return new sa(t)}),this.register(function(t){return new qo(t)}),this.register(function(t){return new $o(t)}),this.register(function(t){return new Zo(t)}),this.register(function(t){return new Qo(t)}),this.register(function(t){return new Ko(t)}),this.register(function(t){return new Jo(t)}),this.register(function(t){return new Yo(t)}),this.register(function(t){return new ta(t)}),this.register(function(t){return new ea(t)}),this.register(function(t){return new Ho(t)}),this.register(function(t){return new ra(t)}),this.register(function(t){return new oa(t)})}load(e,t,i,n){const s=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const c=Yt.extractUrlBase(e);r=Yt.resolveURL(c,this.path)}else r=Yt.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){n?n(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Es(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,r,function(h){t(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let s;const r={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===Fs){try{r[v.KHR_BINARY_GLTF]=new aa(e)}catch(u){n&&n(u);return}s=JSON.parse(r[v.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new ba(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](c);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[u.name]=u,r[u.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const u=s.extensionsUsed[h],d=s.extensionsRequired||[];switch(u){case v.KHR_MATERIALS_UNLIT:r[u]=new Bo;break;case v.KHR_DRACO_MESH_COMPRESSION:r[u]=new la(s,this.dracoLoader);break;case v.KHR_TEXTURE_TRANSFORM:r[u]=new ca;break;case v.KHR_MESH_QUANTIZATION:r[u]=new ha;break;default:d.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(r),c.setPlugins(a),c.parse(i,n)}parseAsync(e,t){const i=this;return new Promise(function(n,s){i.parse(e,t,n,s)})}}function Vo(){let o={};return{get:function(e){return o[e]},add:function(e,t){o[e]=t},remove:function(e){delete o[e]},removeAll:function(){o={}}}}const v={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Ho{constructor(e){this.parser=e,this.name=v.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let n=t.cache.get(i);if(n)return n;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new Ee(16777215);l.color!==void 0&&h.setRGB(l.color[0],l.color[1],l.color[2],Ue);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new As(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new vs(h),c.distance=u;break;case"spot":c=new Yr(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),Ie(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),n=Promise.resolve(c),t.cache.add(i,n),n}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class Bo{constructor(){this.name=v.KHR_MATERIALS_UNLIT}getMaterialType(){return He}extendParams(e,t,i){const n=[];e.color=new Ee(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const r=s.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],Ue),e.opacity=r[3]}s.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",s.baseColorTexture,Lt))}return Promise.all(n)}}class Ko{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class Xo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ae(a,a)}return Promise.all(s)}}class Wo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_DISPERSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class Yo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(s)}}class qo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Ee(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=n.extensions[this.name];if(r.sheenColorFactor!==void 0){const a=r.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Ue)}return r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",r.sheenColorTexture,Lt)),r.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(s)}}class $o{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(s)}}class Zo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new Ee().setRGB(a[0],a[1],a[2],Ue),Promise.all(s)}}class Qo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Jo{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new Ee().setRGB(a[0],a[1],a[2],Ue),r.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",r.specularColorTexture,Lt)),Promise.all(s)}}class ea{constructor(e){this.parser=e,this.name=v.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return t.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",r.bumpTexture)),Promise.all(s)}}class ta{constructor(e){this.parser=e,this.name=v.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ce}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],r=n.extensions[this.name];return r.anisotropyStrength!==void 0&&(t.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(t.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",r.anisotropyTexture)),Promise.all(s)}}class ia{constructor(e){this.parser=e,this.name=v.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,r)}}class na{constructor(e){this.parser=e,this.name=v.EXT_TEXTURE_WEBP}loadTexture(e){const t=this.name,i=this.parser,n=i.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const r=s.extensions[t],a=n.images[r.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return i.loadTextureImage(e,r.source,l)}}class sa{constructor(e){this.parser=e,this.name=v.EXT_TEXTURE_AVIF}loadTexture(e){const t=this.name,i=this.parser,n=i.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const r=s.extensions[t],a=n.images[r.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return i.loadTextureImage(e,r.source,l)}}class ra{constructor(e){this.name=v.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const n=i.extensions[this.name],s=this.parser.getDependency("buffer",n.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=n.byteOffset||0,c=n.byteLength||0,h=n.count,u=n.byteStride,d=new Uint8Array(a,l,c);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(h,u,d,n.mode,n.filter).then(function(p){return p.buffer}):r.ready.then(function(){const p=new ArrayBuffer(h*u);return r.decodeGltfBuffer(new Uint8Array(p),h,u,d,n.mode,n.filter),p})})}else return null}}class oa{constructor(e){this.name=v.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const n=t.meshes[i.mesh];for(const c of n.primitives)if(c.mode!==be.TRIANGLES&&c.mode!==be.TRIANGLE_STRIP&&c.mode!==be.TRIANGLE_FAN&&c.mode!==void 0)return null;const r=i.extensions[this.name].attributes,a=[],l={};for(const c in r)a.push(this.parser.getDependency("accessor",r[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,p=[];for(const m of u){const f=new Se,_=new R,g=new Jt,w=new R(1,1,1),T=new qr(m.geometry,m.material,d);for(let y=0;y<d;y++)l.TRANSLATION&&_.fromBufferAttribute(l.TRANSLATION,y),l.ROTATION&&g.fromBufferAttribute(l.ROTATION,y),l.SCALE&&w.fromBufferAttribute(l.SCALE,y),T.setMatrixAt(y,f.compose(_,g,w));for(const y in l)if(y==="_COLOR_0"){const b=l[y];T.instanceColor=new $r(b.array,b.itemSize,b.normalized)}else y!=="TRANSLATION"&&y!=="ROTATION"&&y!=="SCALE"&&m.geometry.setAttribute(y,l[y]);mn.prototype.copy.call(T,m),this.parser.assignFinalMaterial(T),p.push(T)}return h.isGroup?(h.clear(),h.add(...p),h):p[0]}))}}const Fs="glTF",Ht=12,Zn={JSON:1313821514,BIN:5130562};class aa{constructor(e){this.name=v.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Ht),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Fs)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Ht,s=new DataView(e,Ht);let r=0;for(;r<n;){const a=s.getUint32(r,!0);r+=4;const l=s.getUint32(r,!0);if(r+=4,l===Zn.JSON){const c=new Uint8Array(e,Ht+r,a);this.content=i.decode(c)}else if(l===Zn.BIN){const c=Ht+r;this.body=e.slice(c,c+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class la{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=v.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},l={},c={};for(const h in r){const u=$i[h]||h.toLowerCase();a[u]=r[h]}for(const h in e.attributes){const u=$i[h]||h.toLowerCase();if(r[h]!==void 0){const d=i.accessors[e.attributes[h]],p=At[d.componentType];c[u]=p.name,l[u]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(h){return new Promise(function(u,d){n.decodeDracoFile(h,function(p){for(const m in p.attributes){const f=p.attributes[m],_=l[m];_!==void 0&&(f.normalized=_)}u(p)},a,c,Ue,d)})})}}class ca{constructor(){this.name=v.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class ha{constructor(){this.name=v.KHR_MESH_QUANTIZATION}}class Us extends mo{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let r=0;r!==n;r++)t[r]=i[s+r];return t}interpolate_(e,t,i,n){const s=this.resultBuffer,r=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=n-t,u=(i-t)/h,d=u*u,p=d*u,m=e*c,f=m-c,_=-2*p+3*d,g=p-d,w=1-_,T=g-d+u;for(let y=0;y!==a;y++){const b=r[f+y+a],S=r[f+y+l]*h,M=r[m+y+a],E=r[m+y]*h;s[y]=w*b+T*S+_*M+g*E}return s}}const ua=new Jt;class da extends Us{interpolate_(e,t,i,n){const s=super.interpolate_(e,t,i,n);return ua.fromArray(s).normalize().toArray(s),s}}const be={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},At={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Qn={9728:Rs,9729:Xi,9984:to,9985:eo,9986:Jr,9987:Ps},Jn={33071:no,33648:io,10497:Wi},Ii={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},$i={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},je={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},fa={CUBICSPLINE:void 0,LINEAR:Is,STEP:fo},Ni={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function pa(o){return o.DefaultMaterial===void 0&&(o.DefaultMaterial=new gn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Yi})),o.DefaultMaterial}function ot(o,e,t){for(const i in t.extensions)o[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Ie(o,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(o.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ma(o,e,t){let i=!1,n=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(i=!0),u.NORMAL!==void 0&&(n=!0),u.COLOR_0!==void 0&&(s=!0),i&&n&&s)break}if(!i&&!n&&!s)return Promise.resolve(o);const r=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(i){const d=u.POSITION!==void 0?t.getDependency("accessor",u.POSITION):o.attributes.position;r.push(d)}if(n){const d=u.NORMAL!==void 0?t.getDependency("accessor",u.NORMAL):o.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?t.getDependency("accessor",u.COLOR_0):o.attributes.color;l.push(d)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return i&&(o.morphAttributes.position=h),n&&(o.morphAttributes.normal=u),s&&(o.morphAttributes.color=d),o.morphTargetsRelative=!0,o})}function _a(o,e){if(o.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)o.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(o.morphTargetInfluences.length===t.length){o.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)o.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ga(o){let e;const t=o.extensions&&o.extensions[v.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+ki(t.attributes):e=o.indices+":"+ki(o.attributes)+":"+o.mode,o.targets!==void 0)for(let i=0,n=o.targets.length;i<n;i++)e+=":"+ki(o.targets[i]);return e}function ki(o){let e="";const t=Object.keys(o).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+o[t[i]]+";";return e}function Zi(o){switch(o){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function wa(o){return o.search(/\.jpe?g($|\?)/i)>0||o.search(/^data\:image\/jpeg/)===0?"image/jpeg":o.search(/\.webp($|\?)/i)>0||o.search(/^data\:image\/webp/)===0?"image/webp":o.search(/\.ktx2($|\?)/i)>0||o.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const ya=new Se;class ba{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Vo,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=-1,s=!1,r=-1;if(typeof navigator<"u"){const a=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(a)===!0;const l=a.match(/Version\/(\d+)/);n=i&&l?parseInt(l[1],10):-1,s=a.indexOf("Firefox")>-1,r=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&n<17||s&&r<98?this.textureLoader=new _n(this.options.manager):this.textureLoader=new Zr(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Es(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(r){const a={scene:r[0][n.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:n.asset,parser:i,userData:{}};return ot(s,a,n),Ie(a,n),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n].joints;for(let a=0,l=r.length;a<l;a++)e[r[a]].isBone=!0}for(let n=0,s=e.length;n<s;n++){const r=e[n];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(i[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const n=i.clone(),s=(r,a)=>{const l=this.associations.get(r);l!=null&&this.associations.set(a,l);for(const[c,h]of r.children.entries())s(h,a.children[c])};return s(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let n=0;n<t.length;n++){const s=e(t[n]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":n=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(s,r){return i.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[v.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(s,r){i.load(Yt.resolveURL(t.uri,n.path),s,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const n=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+n)})}loadAccessor(e){const t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){const r=Ii[n.type],a=At[n.componentType],l=n.normalized===!0,c=new a(n.count*r);return Promise.resolve(new Li(c,r,l))}const s=[];return n.bufferView!==void 0?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),n.sparse!==void 0&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(r){const a=r[0],l=Ii[n.type],c=At[n.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=n.byteOffset||0,p=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,m=n.normalized===!0;let f,_;if(p&&p!==u){const g=Math.floor(d/p),w="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count;let T=t.cache.get(w);T||(f=new c(a,g*p,n.count*p/h),T=new Qr(f,p/h),t.cache.add(w,T)),_=new po(T,l,d%p/h,m)}else a===null?f=new c(n.count*l):f=new c(a,d,n.count*l),_=new Li(f,l,m);if(n.sparse!==void 0){const g=Ii.SCALAR,w=At[n.sparse.indices.componentType],T=n.sparse.indices.byteOffset||0,y=n.sparse.values.byteOffset||0,b=new w(r[1],T,n.sparse.count*g),S=new c(r[2],y,n.sparse.count*l);a!==null&&(_=new Li(_.array.slice(),_.itemSize,_.normalized)),_.normalized=!1;for(let M=0,E=b.length;M<E;M++){const x=b[M];if(_.setX(x,S[M*l]),l>=2&&_.setY(x,S[M*l+1]),l>=3&&_.setZ(x,S[M*l+2]),l>=4&&_.setW(x,S[M*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}_.normalized=m}return _})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,r=t.images[s];let a=this.textureLoader;if(r.uri){const l=i.manager.getHandler(r.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const n=this,s=this.json,r=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(h){h.flipY=!1,h.name=r.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[r.sampler]||{};return h.magFilter=Qn[d.magFilter]||Xi,h.minFilter=Qn[d.minFilter]||Ps,h.wrapS=Jn[d.wrapS]||Wi,h.wrapT=Jn[d.wrapT]||Wi,h.generateMipmaps=!h.isCompressedTexture&&h.minFilter!==Rs&&h.minFilter!==Xi,n.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const i=this,n=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const r=n.images[e],a=self.URL||self.webkitURL;let l=r.uri||"",c=!1;if(r.bufferView!==void 0)l=i.getDependency("bufferView",r.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:r.mimeType});return l=a.createObjectURL(d),l});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,p){let m=d;t.isImageBitmapLoader===!0&&(m=function(f){const _=new zn(f);_.needsUpdate=!0,d(_)}),t.load(Yt.resolveURL(u,s.path),m,void 0,p)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),Ie(u,r),u.userData.mimeType=r.mimeType||wa(r.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,t,i,n){const s=this;return this.getDependency("texture",i.index).then(function(r){if(!r)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(r=r.clone(),r.channel=i.texCoord),s.extensions[v.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[v.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(r);r=s.extensions[v.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),s.associations.set(r,l)}}return n!==void 0&&(r.colorSpace=n),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const n=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Os,Ci.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Ei,Ci.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(n||s||r){let a="ClonedMaterial:"+i.uuid+":";n&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),r&&(l.flatShading=!0),n&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return gn}loadMaterial(e){const t=this,i=this.json,n=this.extensions,s=i.materials[e];let r;const a={},l=s.extensions||{},c=[];if(l[v.KHR_MATERIALS_UNLIT]){const u=n[v.KHR_MATERIALS_UNLIT];r=u.getMaterialType(),c.push(u.extendParams(a,s,t))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new Ee(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Ue),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",u.baseColorTexture,Lt)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),r=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Ls);const h=s.alphaMode||Ni.OPAQUE;if(h===Ni.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===Ni.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&r!==He&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ae(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}if(s.occlusionTexture!==void 0&&r!==He&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&r!==He){const u=s.emissiveFactor;a.emissive=new Ee().setRGB(u[0],u[1],u[2],Ue)}return s.emissiveTexture!==void 0&&r!==He&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Lt)),Promise.all(c).then(function(){const u=new r(a);return s.name&&(u.name=s.name),Ie(u,s),t.associations.set(u,{materials:e}),s.extensions&&ot(n,u,s),u})}createUniqueName(e){const t=so.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,n=this.primitiveCache;function s(a){return i[v.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return es(l,a,t)})}const r=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=ga(c),u=n[h];if(u)r.push(u.promise);else{let d;c.extensions&&c.extensions[v.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=es(new ai,c,t),n[h]={primitive:c,promise:d},r.push(d)}}return Promise.all(r)}loadMesh(e){const t=this,i=this.json,n=this.extensions,s=i.meshes[e],r=s.primitives,a=[];for(let l=0,c=r.length;l<c;l++){const h=r[l].material===void 0?pa(this.cache):this.getDependency("material",r[l].material);a.push(h)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let p=0,m=h.length;p<m;p++){const f=h[p],_=r[p];let g;const w=c[p];if(_.mode===be.TRIANGLES||_.mode===be.TRIANGLE_STRIP||_.mode===be.TRIANGLE_FAN||_.mode===void 0)g=s.isSkinnedMesh===!0?new ro(f,w):new ut(f,w),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),_.mode===be.TRIANGLE_STRIP?g.geometry=$n(g.geometry,Ss):_.mode===be.TRIANGLE_FAN&&(g.geometry=$n(g.geometry,Ki));else if(_.mode===be.LINES)g=new oo(f,w);else if(_.mode===be.LINE_STRIP)g=new vi(f,w);else if(_.mode===be.LINE_LOOP)g=new ao(f,w);else if(_.mode===be.POINTS)g=new Cs(f,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_.mode);Object.keys(g.geometry.morphAttributes).length>0&&_a(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),Ie(g,s),_.extensions&&ot(n,g,_),t.assignFinalMaterial(g),u.push(g)}for(let p=0,m=u.length;p<m;p++)t.associations.set(u[p],{meshes:e,primitives:p});if(u.length===1)return s.extensions&&ot(n,u[0],s),u[0];const d=new di;s.extensions&&ot(n,d,s),t.associations.set(d,{meshes:e});for(let p=0,m=u.length;p<m;p++)d.add(u[p]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Ds(Ye.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new lo(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Ie(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let n=0,s=t.joints.length;n<s;n++)i.push(this._loadNodeShallow(t.joints[n]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(n){const s=n.pop(),r=n,a=[],l=[];for(let c=0,h=r.length;c<h;c++){const u=r[c];if(u){a.push(u);const d=new Se;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new co(a,l)})}loadAnimation(e){const t=this.json,i=this,n=t.animations[e],s=n.name?n.name:"animation_"+e,r=[],a=[],l=[],c=[],h=[];for(let u=0,d=n.channels.length;u<d;u++){const p=n.channels[u],m=n.samplers[p.sampler],f=p.target,_=f.node,g=n.parameters!==void 0?n.parameters[m.input]:m.input,w=n.parameters!==void 0?n.parameters[m.output]:m.output;f.node!==void 0&&(r.push(this.getDependency("node",_)),a.push(this.getDependency("accessor",g)),l.push(this.getDependency("accessor",w)),c.push(m),h.push(f))}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(h)]).then(function(u){const d=u[0],p=u[1],m=u[2],f=u[3],_=u[4],g=[];for(let w=0,T=d.length;w<T;w++){const y=d[w],b=p[w],S=m[w],M=f[w],E=_[w];if(y===void 0)continue;y.updateMatrix&&y.updateMatrix();const x=i._createAnimationTracks(y,b,S,M,E);if(x)for(let P=0;P<x.length;P++)g.push(x[P])}return new ho(s,void 0,g)})}createNodeMesh(e){const t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(s){const r=i._getNodeRef(i.meshCache,n.mesh,s);return n.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let l=0,c=n.weights.length;l<c;l++)a.morphTargetInfluences[l]=n.weights[l]}),r})}loadNode(e){const t=this.json,i=this,n=t.nodes[e],s=i._loadNodeShallow(e),r=[],a=n.children||[];for(let c=0,h=a.length;c<h;c++)r.push(i.getDependency("node",a[c]));const l=n.skin===void 0?Promise.resolve(null):i.getDependency("skin",n.skin);return Promise.all([s,Promise.all(r),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(p){p.isSkinnedMesh&&p.bind(d,ya)});for(let p=0,m=u.length;p<m;p++)h.add(u[p]);return h})}_loadNodeShallow(e){const t=this.json,i=this.extensions,n=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],r=s.name?n.createUniqueName(s.name):"",a=[],l=n._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(n.getDependency("camera",s.camera).then(function(c){return n._getNodeRef(n.cameraCache,s.camera,c)})),n._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new uo:c.length>1?h=new di:c.length===1?h=c[0]:h=new mn,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=r),Ie(h,s),s.extensions&&ot(i,h,s),s.matrix!==void 0){const u=new Se;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);if(!n.associations.has(h))n.associations.set(h,{});else if(s.mesh!==void 0&&n.meshCache.refs[s.mesh]>1){const u=n.associations.get(h);n.associations.set(h,{...u})}return n.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],n=this,s=new di;i.name&&(s.name=n.createUniqueName(i.name)),Ie(s,i),i.extensions&&ot(t,s,i);const r=i.nodes||[],a=[];for(let l=0,c=r.length;l<c;l++)a.push(n.getDependency("node",r[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,p]of n.associations)(d instanceof Ci||d instanceof zn)&&u.set(d,p);return h.traverse(d=>{const p=n.associations.get(d);p!=null&&u.set(d,p)}),u};return n.associations=c(s),s})}_createAnimationTracks(e,t,i,n,s){const r=[],a=e.name?e.name:e.uuid,l=[];je[s.path]===je.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let c;switch(je[s.path]){case je.weights:c=jn;break;case je.rotation:c=Vn;break;case je.translation:case je.scale:c=Gn;break;default:switch(i.itemSize){case 1:c=jn;break;case 2:case 3:default:c=Gn;break}break}const h=n.interpolation!==void 0?fa[n.interpolation]:Is,u=this._getArrayFromAccessor(i);for(let d=0,p=l.length;d<p;d++){const m=new c(l[d]+"."+je[s.path],t.array,u,h);n.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(m),r.push(m)}return r}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=Zi(t.constructor),n=new Float32Array(t.length);for(let s=0,r=t.length;s<r;s++)n[s]=t[s]*i;t=n}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const n=this instanceof Vn?da:Us;return new n(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Ta(o,e,t){const i=e.attributes,n=new _o;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(n.set(new R(l[0],l[1],l[2]),new R(c[0],c[1],c[2])),a.normalized){const h=Zi(At[a.componentType]);n.min.multiplyScalar(h),n.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new R,l=new R;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=t.json.accessors[u.POSITION],p=d.min,m=d.max;if(p!==void 0&&m!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(m[2]))),d.normalized){const f=Zi(At[d.componentType]);l.multiplyScalar(f)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(a)}o.boundingBox=n;const r=new go;n.getCenter(r.center),r.radius=n.min.distanceTo(n.max)/2,o.boundingSphere=r}function es(o,e,t){const i=e.attributes,n=[];function s(r,a){return t.getDependency("accessor",r).then(function(l){o.setAttribute(a,l)})}for(const r in i){const a=$i[r]||r.toLowerCase();a in o.attributes||n.push(s(i[r],a))}if(e.indices!==void 0&&!o.index){const r=t.getDependency("accessor",e.indices).then(function(a){o.setIndex(a)});n.push(r)}return Hn.workingColorSpace!==Ue&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Hn.workingColorSpace}" not supported.`),Ie(o,e),Ta(o,e,t),Promise.all(n).then(function(){return e.targets!==void 0?ma(o,e.targets,t):o})}class zs extends mn{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new ae(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const yt=new R,ts=new Se,is=new Se,ns=new R,ss=new R;class xa{constructor(e={}){const t=this;let i,n,s,r;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:n}},this.render=function(m,f){m.matrixWorldAutoUpdate===!0&&m.updateMatrixWorld(),f.parent===null&&f.matrixWorldAutoUpdate===!0&&f.updateMatrixWorld(),ts.copy(f.matrixWorldInverse),is.multiplyMatrices(f.projectionMatrix,ts),h(m,m,f),p(m)},this.setSize=function(m,f){i=m,n=f,s=i/2,r=n/2,l.style.width=m+"px",l.style.height=f+"px"};function c(m){m.isCSS2DObject&&(m.element.style.display="none");for(let f=0,_=m.children.length;f<_;f++)c(m.children[f])}function h(m,f,_){if(m.visible===!1){c(m);return}if(m.isCSS2DObject){yt.setFromMatrixPosition(m.matrixWorld),yt.applyMatrix4(is);const g=yt.z>=-1&&yt.z<=1&&m.layers.test(_.layers)===!0,w=m.element;w.style.display=g===!0?"":"none",g===!0&&(m.onBeforeRender(t,f,_),w.style.transform="translate("+-100*m.center.x+"%,"+-100*m.center.y+"%)translate("+(yt.x*s+s)+"px,"+(-yt.y*r+r)+"px)",w.parentNode!==l&&l.appendChild(w),m.onAfterRender(t,f,_));const T={distanceToCameraSquared:u(_,m)};a.objects.set(m,T)}for(let g=0,w=m.children.length;g<w;g++)h(m.children[g],f,_)}function u(m,f){return ns.setFromMatrixPosition(m.matrixWorld),ss.setFromMatrixPosition(f.matrixWorld),ns.distanceToSquared(ss)}function d(m){const f=[];return m.traverseVisible(function(_){_.isCSS2DObject&&f.push(_)}),f}function p(m){const f=d(m).sort(function(g,w){if(g.renderOrder!==w.renderOrder)return w.renderOrder-g.renderOrder;const T=a.objects.get(g).distanceToCameraSquared,y=a.objects.get(w).distanceToCameraSquared;return T-y}),_=f.length;for(let g=0,w=f.length;g<w;g++)f[g].element.style.zIndex=_-g}}}const Ma="/textures/stars/circle.png";function Sa({numStars:o=500}={}){function e(){const l=Math.random()*25+25,c=Math.random(),h=Math.random(),u=2*Math.PI*c,d=Math.acos(2*h-1);let p=l*Math.sin(d)*Math.cos(u),m=l*Math.sin(d)*Math.sin(u),f=l*Math.cos(d);return{pos:new R(p,m,f),hue:.6,minDist:l}}const t=[],i=[];for(let l=0;l<o;l++){let c=e();const{pos:h,hue:u}=c,d=new Ee().setHSL(u,.2,Math.random());t.push(h.x,h.y,h.z),i.push(d.r,d.g,d.b)}const n=new ai;n.setAttribute("position",new Bn(t,3)),n.setAttribute("color",new Bn(i,3));const s=new _n().load(Ma),r=new Os({size:.2,vertexColors:!0,map:s,transparent:!0,depthWrite:!1});return new Cs(n,r)}function Ne(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function Gs(o,e){o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var _e={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ct={duration:.5,overwrite:!1,delay:0},yn,te,U,Oe=1e8,ne=1/Oe,Qi=Math.PI*2,Ea=Qi/4,va=0,js=Math.sqrt,Aa=Math.cos,Pa=Math.sin,J=function(e){return typeof e=="string"},j=function(e){return typeof e=="function"},ze=function(e){return typeof e=="number"},bn=function(e){return typeof e>"u"},Le=function(e){return typeof e=="object"},le=function(e){return e!==!1},Tn=function(){return typeof window<"u"},ui=function(e){return j(e)||J(e)},Vs=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},se=Array.isArray,Ji=/(?:-?\.?\d|\.)+/gi,Hs=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,xt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Fi=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Bs=/[+-]=-?[.\d]+/,Ks=/[^,'"\[\]\s]+/gi,Ra=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,z,ve,en,xn,ge={},gi={},Xs,Ws=function(e){return(gi=Dt(e,ge))&&de},Mn=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ei=function(e,t){return!t&&console.warn(e)},Ys=function(e,t){return e&&(ge[e]=t)&&gi&&(gi[e]=t)||ge},ti=function(){return 0},Oa={suppressEvents:!0,isStart:!0,kill:!1},fi={suppressEvents:!0,kill:!1},La={suppressEvents:!0},Sn={},qe=[],tn={},qs,fe={},Ui={},rs=30,pi=[],En="",vn=function(e){var t=e[0],i,n;if(Le(t)||j(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=pi.length;n--&&!pi[n].targetTest(t););i=pi[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new yr(e[n],i)))||e.splice(n,1);return e},dt=function(e){return e._gsap||vn(Te(e))[0]._gsap},$s=function(e,t,i){return(i=e[t])&&j(i)?e[t]():bn(i)&&e.getAttribute&&e.getAttribute(t)||i},ce=function(e,t){return(e=e.split(",")).forEach(t)||e},V=function(e){return Math.round(e*1e5)/1e5||0},K=function(e){return Math.round(e*1e7)/1e7||0},Pt=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},Ca=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},wi=function(){var e=qe.length,t=qe.slice(0),i,n;for(tn={},qe.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},An=function(e){return!!(e._initted||e._startAt||e.add)},Zs=function(e,t,i,n){qe.length&&!te&&wi(),e.render(t,i,!!(te&&t<0&&An(e))),qe.length&&!te&&wi()},Qs=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Ks).length<2?t:J(e)?e.trim():e},Js=function(e){return e},we=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Da=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},Dt=function(e,t){for(var i in t)e[i]=t[i];return e},os=function o(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Le(t[i])?o(e[i]||(e[i]={}),t[i]):t[i]);return e},yi=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},$t=function(e){var t=e.parent||z,i=e.keyframes?Da(se(e.keyframes)):we;if(le(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},Ia=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},er=function(e,t,i,n,s){var r=e[n],a;if(s)for(a=t[s];r&&r[s]>a;)r=r._prev;return r?(t._next=r._next,r._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=r,t.parent=t._dp=e,t},Ai=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=t._prev,r=t._next;s?s._next=r:e[i]===t&&(e[i]=r),r?r._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},Je=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},ft=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Na=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},nn=function(e,t,i,n){return e._startAt&&(te?e._startAt.revert(fi):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},ka=function o(e){return!e||e._ts&&o(e.parent)},as=function(e){return e._repeat?It(e._tTime,e=e.duration()+e._rDelay)*e:0},It=function(e,t){var i=Math.floor(e=K(e/t));return e&&i===e?i-1:i},bi=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Pi=function(e){return e._end=K(e._start+(e._tDur/Math.abs(e._ts||e._rts||ne)||0))},Ri=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=K(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Pi(e),i._dirty||ft(i,e)),e},tr=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=bi(e.rawTime(),t),(!t._dur||li(0,t.totalDuration(),i)-t._tTime>ne)&&t.render(i,!0)),ft(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-1e-8}},Ae=function(e,t,i,n){return t.parent&&Je(t),t._start=K((ze(i)?i:i||e!==z?ye(e,i,t):e._time)+t._delay),t._end=K(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),er(e,t,"_first","_last",e._sort?"_start":0),sn(t)||(e._recent=t),n||tr(e,t),e._ts<0&&Ri(e,e._tTime),e},ir=function(e,t){return(ge.ScrollTrigger||Mn("scrollTrigger",t))&&ge.ScrollTrigger.create(t,e)},nr=function(e,t,i,n,s){if(Rn(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!te&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&qs!==pe.frame)return qe.push(e),e._lazy=[s,n],1},Fa=function o(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||o(t))},sn=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},Ua=function(e,t,i,n){var s=e.ratio,r=t<0||!t&&(!e._start&&Fa(e)&&!(!e._initted&&sn(e))||(e._ts<0||e._dp._ts<0)&&!sn(e))?0:1,a=e._rDelay,l=0,c,h,u;if(a&&e._repeat&&(l=li(0,e._tDur,t),h=It(l,a),e._yoyo&&h&1&&(r=1-r),h!==It(e._tTime,a)&&(s=1-r,e.vars.repeatRefresh&&e._initted&&e.invalidate())),r!==s||te||n||e._zTime===ne||!t&&e._zTime){if(!e._initted&&nr(e,t,n,i,l))return;for(u=e._zTime,e._zTime=t||(i?ne:0),i||(i=t&&!u),e.ratio=r,e._from&&(r=1-r),e._time=0,e._tTime=l,c=e._pt;c;)c.r(r,c.d),c=c._next;t<0&&nn(e,t,i,!0),e._onUpdate&&!i&&me(e,"onUpdate"),l&&e._repeat&&!i&&e.parent&&me(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===r&&(r&&Je(e,1),!i&&!te&&(me(e,r?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},za=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},Nt=function(e,t,i,n){var s=e._repeat,r=K(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=r/e._dur),e._dur=r,e._tDur=s?s<0?1e10:K(r*(s+1)+e._rDelay*s):r,a>0&&!n&&Ri(e,e._tTime=e._tDur*a),e.parent&&Pi(e),i||ft(e.parent,e),e},ls=function(e){return e instanceof re?ft(e):Nt(e,e._dur)},Ga={_start:0,endTime:ti,totalDuration:ti},ye=function o(e,t,i){var n=e.labels,s=e._recent||Ga,r=e.duration()>=Oe?s.endTime(!1):e._dur,a,l,c;return J(t)&&(isNaN(t)||t in n)?(l=t.charAt(0),c=t.substr(-1)==="%",a=t.indexOf("="),l==="<"||l===">"?(a>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(a<0?s:i).totalDuration()/100:1)):a<0?(t in n||(n[t]=r),n[t]):(l=parseFloat(t.charAt(a-1)+t.substr(a+1)),c&&i&&(l=l/100*(se(i)?i[0]:i).totalDuration()),a>1?o(e,t.substr(0,a-1),i)+l:r+l)):t==null?r:+t},Zt=function(e,t,i){var n=ze(t[1]),s=(n?2:1)+(e<2?0:1),r=t[s],a,l;if(n&&(r.duration=t[1]),r.parent=i,e){for(a=r,l=i;l&&!("immediateRender"in a);)a=l.vars.defaults||{},l=le(l.vars.inherit)&&l.parent;r.immediateRender=le(a.immediateRender),e<2?r.runBackwards=1:r.startAt=t[s-1]}return new B(t[0],r,t[s+1])},nt=function(e,t){return e||e===0?t(e):t},li=function(e,t,i){return i<e?e:i>t?t:i},ie=function(e,t){return!J(e)||!(t=Ra.exec(e))?"":t[1]},ja=function(e,t,i){return nt(i,function(n){return li(e,t,n)})},rn=[].slice,sr=function(e,t){return e&&Le(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Le(e[0]))&&!e.nodeType&&e!==ve},Va=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var s;return J(n)&&!t||sr(n,1)?(s=i).push.apply(s,Te(n)):i.push(n)})||i},Te=function(e,t,i){return U&&!t&&U.selector?U.selector(e):J(e)&&!i&&(en||!kt())?rn.call((t||xn).querySelectorAll(e),0):se(e)?Va(e,i):sr(e)?rn.call(e,0):e?[e]:[]},on=function(e){return e=Te(e)[0]||ei("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return Te(t,i.querySelectorAll?i:i===e?ei("Invalid scope")||xn.createElement("div"):e)}},rr=function(e){return e.sort(function(){return .5-Math.random()})},or=function(e){if(j(e))return e;var t=Le(e)?e:{each:e},i=pt(t.ease),n=t.from||0,s=parseFloat(t.base)||0,r={},a=n>0&&n<1,l=isNaN(n)||a,c=t.axis,h=n,u=n;return J(n)?h=u={center:.5,edges:.5,end:1}[n]||0:!a&&l&&(h=n[0],u=n[1]),function(d,p,m){var f=(m||t).length,_=r[f],g,w,T,y,b,S,M,E,x;if(!_){if(x=t.grid==="auto"?0:(t.grid||[1,Oe])[1],!x){for(M=-1e8;M<(M=m[x++].getBoundingClientRect().left)&&x<f;);x<f&&x--}for(_=r[f]=[],g=l?Math.min(x,f)*h-.5:n%x,w=x===Oe?0:l?f*u/x-.5:n/x|0,M=0,E=Oe,S=0;S<f;S++)T=S%x-g,y=w-(S/x|0),_[S]=b=c?Math.abs(c==="y"?y:T):js(T*T+y*y),b>M&&(M=b),b<E&&(E=b);n==="random"&&rr(_),_.max=M-E,_.min=E,_.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(x>f?f-1:c?c==="y"?f/x:x:Math.max(x,f/x))||0)*(n==="edges"?-1:1),_.b=f<0?s-f:s,_.u=ie(t.amount||t.each)||0,i=i&&f<0?_r(i):i}return f=(_[d]-_.min)/_.max||0,K(_.b+(i?i(f):f)*_.v)+_.u}},an=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=K(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(ze(i)?0:ie(i))}},ar=function(e,t){var i=se(e),n,s;return!i&&Le(e)&&(n=i=e.radius||Oe,e.values?(e=Te(e.values),(s=!ze(e[0]))&&(n*=n)):e=an(e.increment)),nt(t,i?j(e)?function(r){return s=e(r),Math.abs(s-r)<=n?s:r}:function(r){for(var a=parseFloat(s?r.x:r),l=parseFloat(s?r.y:0),c=Oe,h=0,u=e.length,d,p;u--;)s?(d=e[u].x-a,p=e[u].y-l,d=d*d+p*p):d=Math.abs(e[u]-a),d<c&&(c=d,h=u);return h=!n||c<=n?e[h]:r,s||h===r||ze(r)?h:h+ie(r)}:an(e))},lr=function(e,t,i,n){return nt(se(e)?!t:i===!0?!!(i=0):!n,function(){return se(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},Ha=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(s,r){return r(s)},n)}},Ba=function(e,t){return function(i){return e(parseFloat(i))+(t||ie(i))}},Ka=function(e,t,i){return hr(e,t,0,1,i)},cr=function(e,t,i){return nt(i,function(n){return e[~~t(n)]})},Xa=function o(e,t,i){var n=t-e;return se(e)?cr(e,o(0,e.length),t):nt(i,function(s){return(n+(s-e)%n)%n+e})},Wa=function o(e,t,i){var n=t-e,s=n*2;return se(e)?cr(e,o(0,e.length-1),t):nt(i,function(r){return r=(s+(r-e)%s)%s||0,e+(r>n?s-r:r)})},ii=function(e){for(var t=0,i="",n,s,r,a;~(n=e.indexOf("random(",t));)r=e.indexOf(")",n),a=e.charAt(n+7)==="[",s=e.substr(n+7,r-n-7).match(a?Ks:Ji),i+=e.substr(t,n-t)+lr(a?s:+s[0],a?0:+s[1],+s[2]||1e-5),t=r+1;return i+e.substr(t,e.length-t)},hr=function(e,t,i,n,s){var r=t-e,a=n-i;return nt(s,function(l){return i+((l-e)/r*a||0)})},Ya=function o(e,t,i,n){var s=isNaN(e+t)?0:function(p){return(1-p)*e+p*t};if(!s){var r=J(e),a={},l,c,h,u,d;if(i===!0&&(n=1)&&(i=null),r)e={p:e},t={p:t};else if(se(e)&&!se(t)){for(h=[],u=e.length,d=u-2,c=1;c<u;c++)h.push(o(e[c-1],e[c]));u--,s=function(m){m*=u;var f=Math.min(d,~~m);return h[f](m-f)},i=t}else n||(e=Dt(se(e)?[]:{},e));if(!h){for(l in t)Pn.call(a,e,l,"get",t[l]);s=function(m){return Cn(m,a)||(r?e.p:e)}}}return nt(i,s)},cs=function(e,t,i){var n=e.labels,s=Oe,r,a,l;for(r in n)a=n[r]-t,a<0==!!i&&a&&s>(a=Math.abs(a))&&(l=r,s=a);return l},me=function(e,t,i){var n=e.vars,s=n[t],r=U,a=e._ctx,l,c,h;if(s)return l=n[t+"Params"],c=n.callbackScope||e,i&&qe.length&&wi(),a&&(U=a),h=l?s.apply(c,l):s.call(c),U=r,h},Kt=function(e){return Je(e),e.scrollTrigger&&e.scrollTrigger.kill(!!te),e.progress()<1&&me(e,"onInterrupt"),e},Mt,ur=[],dr=function(e){if(e)if(e=!e.name&&e.default||e,Tn()||e.headless){var t=e.name,i=j(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:ti,render:Cn,add:Pn,kill:hl,modifier:cl,rawVars:0},r={targetTest:0,get:0,getSetter:Ln,aliases:{},register:0};if(kt(),e!==n){if(fe[t])return;we(n,we(yi(e,s),r)),Dt(n.prototype,Dt(s,yi(e,r))),fe[n.prop=t]=n,e.targetTest&&(pi.push(n),Sn[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Ys(t,n),e.register&&e.register(de,n,he)}else ur.push(e)},D=255,Xt={aqua:[0,D,D],lime:[0,D,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,D],navy:[0,0,128],white:[D,D,D],olive:[128,128,0],yellow:[D,D,0],orange:[D,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[D,0,0],pink:[D,192,203],cyan:[0,D,D],transparent:[D,D,D,0]},zi=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*D+.5|0},fr=function(e,t,i){var n=e?ze(e)?[e>>16,e>>8&D,e&D]:0:Xt.black,s,r,a,l,c,h,u,d,p,m;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Xt[e])n=Xt[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),r=e.charAt(2),a=e.charAt(3),e="#"+s+s+r+r+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&D,n&D,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&D,e&D]}else if(e.substr(0,3)==="hsl"){if(n=m=e.match(Ji),!t)l=+n[0]%360/360,c=+n[1]/100,h=+n[2]/100,r=h<=.5?h*(c+1):h+c-h*c,s=h*2-r,n.length>3&&(n[3]*=1),n[0]=zi(l+1/3,s,r),n[1]=zi(l,s,r),n[2]=zi(l-1/3,s,r);else if(~e.indexOf("="))return n=e.match(Hs),i&&n.length<4&&(n[3]=1),n}else n=e.match(Ji)||Xt.transparent;n=n.map(Number)}return t&&!m&&(s=n[0]/D,r=n[1]/D,a=n[2]/D,u=Math.max(s,r,a),d=Math.min(s,r,a),h=(u+d)/2,u===d?l=c=0:(p=u-d,c=h>.5?p/(2-u-d):p/(u+d),l=u===s?(r-a)/p+(r<a?6:0):u===r?(a-s)/p+2:(s-r)/p+4,l*=60),n[0]=~~(l+.5),n[1]=~~(c*100+.5),n[2]=~~(h*100+.5)),i&&n.length<4&&(n[3]=1),n},pr=function(e){var t=[],i=[],n=-1;return e.split($e).forEach(function(s){var r=s.match(xt)||[];t.push.apply(t,r),i.push(n+=r.length+1)}),t.c=i,t},hs=function(e,t,i){var n="",s=(e+n).match($e),r=t?"hsla(":"rgba(",a=0,l,c,h,u;if(!s)return e;if(s=s.map(function(d){return(d=fr(d,t,1))&&r+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(h=pr(e),l=i.c,l.join(n)!==h.c.join(n)))for(c=e.replace($e,"1").split(xt),u=c.length-1;a<u;a++)n+=c[a]+(~l.indexOf(a)?s.shift()||r+"0,0,0,0)":(h.length?h:s.length?s:i).shift());if(!c)for(c=e.split($e),u=c.length-1;a<u;a++)n+=c[a]+s[a];return n+c[u]},$e=function(){var o="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Xt)o+="|"+e+"\\b";return new RegExp(o+")","gi")}(),qa=/hsl[a]?\(/,mr=function(e){var t=e.join(" "),i;if($e.lastIndex=0,$e.test(t))return i=qa.test(t),e[1]=hs(e[1],i),e[0]=hs(e[0],i,pr(e[1])),!0},ni,pe=function(){var o=Date.now,e=500,t=33,i=o(),n=i,s=1e3/240,r=s,a=[],l,c,h,u,d,p,m=function f(_){var g=o()-n,w=_===!0,T,y,b,S;if((g>e||g<0)&&(i+=g-t),n+=g,b=n-i,T=b-r,(T>0||w)&&(S=++u.frame,d=b-u.time*1e3,u.time=b=b/1e3,r+=T+(T>=s?4:s-T),y=1),w||(l=c(f)),y)for(p=0;p<a.length;p++)a[p](b,d,S,_)};return u={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){Xs&&(!en&&Tn()&&(ve=en=window,xn=ve.document||{},ge.gsap=de,(ve.gsapVersions||(ve.gsapVersions=[])).push(de.version),Ws(gi||ve.GreenSockGlobals||!ve.gsap&&ve||{}),ur.forEach(dr)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&u.sleep(),c=h||function(_){return setTimeout(_,r-u.time*1e3+1|0)},ni=1,m(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),ni=0,c=ti},lagSmoothing:function(_,g){e=_||1/0,t=Math.min(g||33,e)},fps:function(_){s=1e3/(_||240),r=u.time*1e3+s},add:function(_,g,w){var T=g?function(y,b,S,M){_(y,b,S,M),u.remove(T)}:_;return u.remove(_),a[w?"unshift":"push"](T),kt(),T},remove:function(_,g){~(g=a.indexOf(_))&&a.splice(g,1)&&p>=g&&p--},_listeners:a},u}(),kt=function(){return!ni&&pe.wake()},O={},$a=/^[\d.\-M][\d.\-,\s]/,Za=/["']/g,Qa=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],s=1,r=i.length,a,l,c;s<r;s++)l=i[s],a=s!==r-1?l.lastIndexOf(","):l.length,c=l.substr(0,a),t[n]=isNaN(c)?c.replace(Za,"").trim():+c,n=l.substr(a+1).trim();return t},Ja=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},el=function(e){var t=(e+"").split("("),i=O[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[Qa(t[1])]:Ja(e).split(",").map(Qs)):O._CE&&$a.test(e)?O._CE("",e):i},_r=function(e){return function(t){return 1-e(1-t)}},gr=function o(e,t){for(var i=e._first,n;i;)i instanceof re?o(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?o(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},pt=function(e,t){return e&&(j(e)?e:O[e]||el(e))||t},gt=function(e,t,i,n){i===void 0&&(i=function(l){return 1-t(1-l)}),n===void 0&&(n=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:n},r;return ce(e,function(a){O[a]=ge[a]=s,O[r=a.toLowerCase()]=i;for(var l in s)O[r+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=O[a+"."+l]=s[l]}),s},wr=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Gi=function o(e,t,i){var n=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),r=s/Qi*(Math.asin(1/n)||0),a=function(h){return h===1?1:n*Math.pow(2,-10*h)*Pa((h-r)*s)+1},l=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:wr(a);return s=Qi/s,l.config=function(c,h){return o(e,c,h)},l},ji=function o(e,t){t===void 0&&(t=1.70158);var i=function(r){return r?--r*r*((t+1)*r+t)+1:0},n=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:wr(i);return n.config=function(s){return o(e,s)},n};ce("Linear,Quad,Cubic,Quart,Quint,Strong",function(o,e){var t=e<5?e+1:e;gt(o+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});O.Linear.easeNone=O.none=O.Linear.easeIn;gt("Elastic",Gi("in"),Gi("out"),Gi());(function(o,e){var t=1/e,i=2*t,n=2.5*t,s=function(a){return a<t?o*a*a:a<i?o*Math.pow(a-1.5/e,2)+.75:a<n?o*(a-=2.25/e)*a+.9375:o*Math.pow(a-2.625/e,2)+.984375};gt("Bounce",function(r){return 1-s(1-r)},s)})(7.5625,2.75);gt("Expo",function(o){return Math.pow(2,10*(o-1))*o+o*o*o*o*o*o*(1-o)});gt("Circ",function(o){return-(js(1-o*o)-1)});gt("Sine",function(o){return o===1?1:-Aa(o*Ea)+1});gt("Back",ji("in"),ji("out"),ji());O.SteppedEase=O.steps=ge.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,r=1-ne;return function(a){return((n*li(0,r,a)|0)+s)*i}}};Ct.ease=O["quad.out"];ce("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(o){return En+=o+","+o+"Params,"});var yr=function(e,t){this.id=va++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:$s,this.set=t?t.getSetter:Ln},si=function(){function o(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Nt(this,+t.duration,1,1),this.data=t.data,U&&(this._ctx=U,U.data.push(this)),ni||pe.wake()}var e=o.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Nt(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(kt(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(Ri(this,i),!s._dp||s.parent||tr(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&Ae(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===ne||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Zs(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+as(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+as(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,n){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,n):this._repeat?It(this._tTime,s)+1:1},e.timeScale=function(i,n){if(!arguments.length)return this._rts===-1e-8?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?bi(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-1e-8?0:this._rts,this.totalTime(li(-Math.abs(this._delay),this.totalDuration(),s),n!==!1),Pi(this),Na(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(kt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==ne&&(this._tTime-=ne)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&Ae(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(le(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?bi(n.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=La);var n=te;return te=i,An(this)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),te=n,this},e.globalTime=function(i){for(var n=this,s=arguments.length?i:n.rawTime();n;)s=n._start+s/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,ls(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,ls(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(ye(this,i),le(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,le(n)),this._dur||(this._zTime=-1e-8),this},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=n&&s<this.endTime(!0)-ne)},e.eventCallback=function(i,n,s){var r=this.vars;return arguments.length>1?(n?(r[i]=n,s&&(r[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=n)):delete r[i],this):r[i]},e.then=function(i){var n=this;return new Promise(function(s){var r=j(i)?i:Js,a=function(){var c=n.then;n.then=null,j(r)&&(r=r(n))&&(r.then||r===n)&&(n.then=c),s(r),n.then=c};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?a():n._prom=a})},e.kill=function(){Kt(this)},o}();we(si.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var re=function(o){Gs(e,o);function e(i,n){var s;return i===void 0&&(i={}),s=o.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=le(i.sortChildren),z&&Ae(i.parent||z,Ne(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&ir(Ne(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(n,s,r){return Zt(0,arguments,this),this},t.from=function(n,s,r){return Zt(1,arguments,this),this},t.fromTo=function(n,s,r,a){return Zt(2,arguments,this),this},t.set=function(n,s,r){return s.duration=0,s.parent=this,$t(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new B(n,s,ye(this,r),1),this},t.call=function(n,s,r){return Ae(this,B.delayedCall(0,n,s),r)},t.staggerTo=function(n,s,r,a,l,c,h){return r.duration=s,r.stagger=r.stagger||a,r.onComplete=c,r.onCompleteParams=h,r.parent=this,new B(n,r,ye(this,l)),this},t.staggerFrom=function(n,s,r,a,l,c,h){return r.runBackwards=1,$t(r).immediateRender=le(r.immediateRender),this.staggerTo(n,s,r,a,l,c,h)},t.staggerFromTo=function(n,s,r,a,l,c,h,u){return a.startAt=r,$t(a).immediateRender=le(a.immediateRender),this.staggerTo(n,s,a,l,c,h,u)},t.render=function(n,s,r){var a=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=n<=0?0:K(n),u=this._zTime<0!=n<0&&(this._initted||!c),d,p,m,f,_,g,w,T,y,b,S,M;if(this!==z&&h>l&&n>=0&&(h=l),h!==this._tTime||r||u){if(a!==this._time&&c&&(h+=this._time-a,n+=this._time-a),d=h,y=this._start,T=this._ts,g=!T,u&&(c||(a=this._zTime),(n||!s)&&(this._zTime=n)),this._repeat){if(S=this._yoyo,_=c+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(_*100+n,s,r);if(d=K(h%_),h===l?(f=this._repeat,d=c):(b=K(h/_),f=~~b,f&&f===b&&(d=c,f--),d>c&&(d=c)),b=It(this._tTime,_),!a&&this._tTime&&b!==f&&this._tTime-b*_-this._dur<=0&&(b=f),S&&f&1&&(d=c-d,M=1),f!==b&&!this._lock){var E=S&&b&1,x=E===(S&&f&1);if(f<b&&(E=!E),a=E?0:h%c?c:h,this._lock=1,this.render(a||(M?0:K(f*_)),s,!c)._lock=0,this._tTime=h,!s&&this.parent&&me(this,"onRepeat"),this.vars.repeatRefresh&&!M&&(this.invalidate()._lock=1),a&&a!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,x&&(this._lock=2,a=E?c:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!M&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;gr(this,M)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(w=za(this,K(a),K(d)),w&&(h-=d-(d=w._start))),this._tTime=h,this._time=d,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,a=0),!a&&h&&!s&&!b&&(me(this,"onStart"),this._tTime!==h))return this;if(d>=a&&n>=0)for(p=this._first;p;){if(m=p._next,(p._act||d>=p._start)&&p._ts&&w!==p){if(p.parent!==this)return this.render(n,s,r);if(p.render(p._ts>0?(d-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(d-p._start)*p._ts,s,r),d!==this._time||!this._ts&&!g){w=0,m&&(h+=this._zTime=-1e-8);break}}p=m}else{p=this._last;for(var P=n<0?n:d;p;){if(m=p._prev,(p._act||P<=p._end)&&p._ts&&w!==p){if(p.parent!==this)return this.render(n,s,r);if(p.render(p._ts>0?(P-p._start)*p._ts:(p._dirty?p.totalDuration():p._tDur)+(P-p._start)*p._ts,s,r||te&&An(p)),d!==this._time||!this._ts&&!g){w=0,m&&(h+=this._zTime=P?-1e-8:ne);break}}p=m}}if(w&&!s&&(this.pause(),w.render(d>=a?0:-1e-8)._zTime=d>=a?1:-1,this._ts))return this._start=y,Pi(this),this.render(n,s,r);this._onUpdate&&!s&&me(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&a)&&(y===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((n||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&Je(this,1),!s&&!(n<0&&!a)&&(h||a||!l)&&(me(this,h===l&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,s){var r=this;if(ze(s)||(s=ye(this,s,n)),!(n instanceof si)){if(se(n))return n.forEach(function(a){return r.add(a,s)}),this;if(J(n))return this.addLabel(n,s);if(j(n))n=B.delayedCall(0,n);else return this}return this!==n?Ae(this,n,s):this},t.getChildren=function(n,s,r,a){n===void 0&&(n=!0),s===void 0&&(s=!0),r===void 0&&(r=!0),a===void 0&&(a=-1e8);for(var l=[],c=this._first;c;)c._start>=a&&(c instanceof B?s&&l.push(c):(r&&l.push(c),n&&l.push.apply(l,c.getChildren(!0,s,r)))),c=c._next;return l},t.getById=function(n){for(var s=this.getChildren(1,1,1),r=s.length;r--;)if(s[r].vars.id===n)return s[r]},t.remove=function(n){return J(n)?this.removeLabel(n):j(n)?this.killTweensOf(n):(n.parent===this&&Ai(this,n),n===this._recent&&(this._recent=this._last),ft(this))},t.totalTime=function(n,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=K(pe.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),o.prototype.totalTime.call(this,n,s),this._forcing=0,this):this._tTime},t.addLabel=function(n,s){return this.labels[n]=ye(this,s),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,s,r){var a=B.delayedCall(0,s||ti,r);return a.data="isPause",this._hasPause=1,Ae(this,a,ye(this,n))},t.removePause=function(n){var s=this._first;for(n=ye(this,n);s;)s._start===n&&s.data==="isPause"&&Je(s),s=s._next},t.killTweensOf=function(n,s,r){for(var a=this.getTweensOf(n,r),l=a.length;l--;)Be!==a[l]&&a[l].kill(n,s);return this},t.getTweensOf=function(n,s){for(var r=[],a=Te(n),l=this._first,c=ze(s),h;l;)l instanceof B?Ca(l._targets,a)&&(c?(!Be||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&r.push(l):(h=l.getTweensOf(a,s)).length&&r.push.apply(r,h),l=l._next;return r},t.tweenTo=function(n,s){s=s||{};var r=this,a=ye(r,n),l=s,c=l.startAt,h=l.onStart,u=l.onStartParams,d=l.immediateRender,p,m=B.to(r,we({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:s.duration||Math.abs((a-(c&&"time"in c?c.time:r._time))/r.timeScale())||ne,onStart:function(){if(r.pause(),!p){var _=s.duration||Math.abs((a-(c&&"time"in c?c.time:r._time))/r.timeScale());m._dur!==_&&Nt(m,_,0,1).render(m._time,!0,!0),p=1}h&&h.apply(m,u||[])}},s));return d?m.render(0):m},t.tweenFromTo=function(n,s,r){return this.tweenTo(s,we({startAt:{time:ye(this,n)}},r))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),cs(this,ye(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),cs(this,ye(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+ne)},t.shiftChildren=function(n,s,r){r===void 0&&(r=0);for(var a=this._first,l=this.labels,c;a;)a._start>=r&&(a._start+=n,a._end+=n),a=a._next;if(s)for(c in l)l[c]>=r&&(l[c]+=n);return ft(this)},t.invalidate=function(n){var s=this._first;for(this._lock=0;s;)s.invalidate(n),s=s._next;return o.prototype.invalidate.call(this,n)},t.clear=function(n){n===void 0&&(n=!0);for(var s=this._first,r;s;)r=s._next,this.remove(s),s=r;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),ft(this)},t.totalDuration=function(n){var s=0,r=this,a=r._last,l=Oe,c,h,u;if(arguments.length)return r.timeScale((r._repeat<0?r.duration():r.totalDuration())/(r.reversed()?-n:n));if(r._dirty){for(u=r.parent;a;)c=a._prev,a._dirty&&a.totalDuration(),h=a._start,h>l&&r._sort&&a._ts&&!r._lock?(r._lock=1,Ae(r,a,h-a._delay,1)._lock=0):l=h,h<0&&a._ts&&(s-=h,(!u&&!r._dp||u&&u.smoothChildTiming)&&(r._start+=h/r._ts,r._time-=h,r._tTime-=h),r.shiftChildren(-h,!1,-1/0),l=0),a._end>s&&a._ts&&(s=a._end),a=c;Nt(r,r===z&&r._time>s?r._time:s,1,1),r._dirty=0}return r._tDur},e.updateRoot=function(n){if(z._ts&&(Zs(z,bi(n,z)),qs=pe.frame),pe.frame>=rs){rs+=_e.autoSleep||120;var s=z._first;if((!s||!s._ts)&&_e.autoSleep&&pe._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||pe.sleep()}}},e}(si);we(re.prototype,{_lock:0,_hasPause:0,_forcing:0});var tl=function(e,t,i,n,s,r,a){var l=new he(this._pt,e,t,0,1,Er,null,s),c=0,h=0,u,d,p,m,f,_,g,w;for(l.b=i,l.e=n,i+="",n+="",(g=~n.indexOf("random("))&&(n=ii(n)),r&&(w=[i,n],r(w,e,t),i=w[0],n=w[1]),d=i.match(Fi)||[];u=Fi.exec(n);)m=u[0],f=n.substring(c,u.index),p?p=(p+1)%5:f.substr(-5)==="rgba("&&(p=1),m!==d[h++]&&(_=parseFloat(d[h-1])||0,l._pt={_next:l._pt,p:f||h===1?f:",",s:_,c:m.charAt(1)==="="?Pt(_,m)-_:parseFloat(m)-_,m:p&&p<4?Math.round:0},c=Fi.lastIndex);return l.c=c<n.length?n.substring(c,n.length):"",l.fp=a,(Bs.test(n)||g)&&(l.e=0),this._pt=l,l},Pn=function(e,t,i,n,s,r,a,l,c,h){j(n)&&(n=n(s||0,e,r));var u=e[t],d=i!=="get"?i:j(u)?c?e[t.indexOf("set")||!j(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():u,p=j(u)?c?ol:Mr:On,m;if(J(n)&&(~n.indexOf("random(")&&(n=ii(n)),n.charAt(1)==="="&&(m=Pt(d,n)+(ie(d)||0),(m||m===0)&&(n=m))),!h||d!==n||ln)return!isNaN(d*n)&&n!==""?(m=new he(this._pt,e,t,+d||0,n-(d||0),typeof u=="boolean"?ll:Sr,0,p),c&&(m.fp=c),a&&m.modifier(a,this,e),this._pt=m):(!u&&!(t in e)&&Mn(t,n),tl.call(this,e,t,d,n,p,l||_e.stringFilter,c))},il=function(e,t,i,n,s){if(j(e)&&(e=Qt(e,s,t,i,n)),!Le(e)||e.style&&e.nodeType||se(e)||Vs(e))return J(e)?Qt(e,s,t,i,n):e;var r={},a;for(a in e)r[a]=Qt(e[a],s,t,i,n);return r},br=function(e,t,i,n,s,r){var a,l,c,h;if(fe[e]&&(a=new fe[e]).init(s,a.rawVars?t[e]:il(t[e],n,s,r,i),i,n,r)!==!1&&(i._pt=l=new he(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==Mt))for(c=i._ptLookup[i._targets.indexOf(s)],h=a._props.length;h--;)c[a._props[h]]=l;return a},Be,ln,Rn=function o(e,t,i){var n=e.vars,s=n.ease,r=n.startAt,a=n.immediateRender,l=n.lazy,c=n.onUpdate,h=n.runBackwards,u=n.yoyoEase,d=n.keyframes,p=n.autoRevert,m=e._dur,f=e._startAt,_=e._targets,g=e.parent,w=g&&g.data==="nested"?g.vars.targets:_,T=e._overwrite==="auto"&&!yn,y=e.timeline,b,S,M,E,x,P,F,I,N,ee,q,H,$;if(y&&(!d||!s)&&(s="none"),e._ease=pt(s,Ct.ease),e._yEase=u?_r(pt(u===!0?s:u,Ct.ease)):0,u&&e._yoyo&&!e._repeat&&(u=e._yEase,e._yEase=e._ease,e._ease=u),e._from=!y&&!!n.runBackwards,!y||d&&!n.stagger){if(I=_[0]?dt(_[0]).harness:0,H=I&&n[I.prop],b=yi(n,Sn),f&&(f._zTime<0&&f.progress(1),t<0&&h&&a&&!p?f.render(-1,!0):f.revert(h&&m?fi:Oa),f._lazy=0),r){if(Je(e._startAt=B.set(_,we({data:"isStart",overwrite:!1,parent:g,immediateRender:!0,lazy:!f&&le(l),startAt:null,delay:0,onUpdate:c&&function(){return me(e,"onUpdate")},stagger:0},r))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(te||!a&&!p)&&e._startAt.revert(fi),a&&m&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(h&&m&&!f){if(t&&(a=!1),M=we({overwrite:!1,data:"isFromStart",lazy:a&&!f&&le(l),immediateRender:a,stagger:0,parent:g},b),H&&(M[I.prop]=H),Je(e._startAt=B.set(_,M)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(te?e._startAt.revert(fi):e._startAt.render(-1,!0)),e._zTime=t,!a)o(e._startAt,ne,ne);else if(!t)return}for(e._pt=e._ptCache=0,l=m&&le(l)||l&&!m,S=0;S<_.length;S++){if(x=_[S],F=x._gsap||vn(_)[S]._gsap,e._ptLookup[S]=ee={},tn[F.id]&&qe.length&&wi(),q=w===_?S:w.indexOf(x),I&&(N=new I).init(x,H||b,e,q,w)!==!1&&(e._pt=E=new he(e._pt,x,N.name,0,1,N.render,N,0,N.priority),N._props.forEach(function(Me){ee[Me]=E}),N.priority&&(P=1)),!I||H)for(M in b)fe[M]&&(N=br(M,b,e,q,x,w))?N.priority&&(P=1):ee[M]=E=Pn.call(e,x,M,"get",b[M],q,w,0,n.stringFilter);e._op&&e._op[S]&&e.kill(x,e._op[S]),T&&e._pt&&(Be=e,z.killTweensOf(x,ee,e.globalTime(t)),$=!e.parent,Be=0),e._pt&&l&&(tn[F.id]=1)}P&&vr(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!$,d&&t<=0&&y.render(Oe,!0,!0)},nl=function(e,t,i,n,s,r,a,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,u,d,p;if(!c)for(c=e._ptCache[t]=[],d=e._ptLookup,p=e._targets.length;p--;){if(h=d[p][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return ln=1,e.vars[t]="+=0",Rn(e,a),ln=0,l?ei(t+" not eligible for reset"):1;c.push(h)}for(p=c.length;p--;)u=c[p],h=u._pt||u,h.s=(n||n===0)&&!s?n:h.s+(n||0)+r*h.c,h.c=i-h.s,u.e&&(u.e=V(i)+ie(u.e)),u.b&&(u.b=h.s+ie(u.b))},sl=function(e,t){var i=e[0]?dt(e[0]).harness:0,n=i&&i.aliases,s,r,a,l;if(!n)return t;s=Dt({},t);for(r in n)if(r in s)for(l=n[r].split(","),a=l.length;a--;)s[l[a]]=s[r];return s},rl=function(e,t,i,n){var s=t.ease||n||"power1.inOut",r,a;if(se(t))a=i[e]||(i[e]=[]),t.forEach(function(l,c){return a.push({t:c/(t.length-1)*100,v:l,e:s})});else for(r in t)a=i[r]||(i[r]=[]),r==="ease"||a.push({t:parseFloat(e),v:t[r],e:s})},Qt=function(e,t,i,n,s){return j(e)?e.call(t,i,n,s):J(e)&&~e.indexOf("random(")?ii(e):e},Tr=En+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",xr={};ce(Tr+",id,stagger,delay,duration,paused,scrollTrigger",function(o){return xr[o]=1});var B=function(o){Gs(e,o);function e(i,n,s,r){var a;typeof n=="number"&&(s.duration=n,n=s,s=null),a=o.call(this,r?n:$t(n))||this;var l=a.vars,c=l.duration,h=l.delay,u=l.immediateRender,d=l.stagger,p=l.overwrite,m=l.keyframes,f=l.defaults,_=l.scrollTrigger,g=l.yoyoEase,w=n.parent||z,T=(se(i)||Vs(i)?ze(i[0]):"length"in n)?[i]:Te(i),y,b,S,M,E,x,P,F;if(a._targets=T.length?vn(T):ei("GSAP target "+i+" not found. https://gsap.com",!_e.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=p,m||d||ui(c)||ui(h)){if(n=a.vars,y=a.timeline=new re({data:"nested",defaults:f||{},targets:w&&w.data==="nested"?w.vars.targets:T}),y.kill(),y.parent=y._dp=Ne(a),y._start=0,d||ui(c)||ui(h)){if(M=T.length,P=d&&or(d),Le(d))for(E in d)~Tr.indexOf(E)&&(F||(F={}),F[E]=d[E]);for(b=0;b<M;b++)S=yi(n,xr),S.stagger=0,g&&(S.yoyoEase=g),F&&Dt(S,F),x=T[b],S.duration=+Qt(c,Ne(a),b,x,T),S.delay=(+Qt(h,Ne(a),b,x,T)||0)-a._delay,!d&&M===1&&S.delay&&(a._delay=h=S.delay,a._start+=h,S.delay=0),y.to(x,S,P?P(b,x,T):0),y._ease=O.none;y.duration()?c=h=0:a.timeline=0}else if(m){$t(we(y.vars.defaults,{ease:"none"})),y._ease=pt(m.ease||n.ease||"none");var I=0,N,ee,q;if(se(m))m.forEach(function(H){return y.to(T,H,">")}),y.duration();else{S={};for(E in m)E==="ease"||E==="easeEach"||rl(E,m[E],S,m.easeEach);for(E in S)for(N=S[E].sort(function(H,$){return H.t-$.t}),I=0,b=0;b<N.length;b++)ee=N[b],q={ease:ee.e,duration:(ee.t-(b?N[b-1].t:0))/100*c},q[E]=ee.v,y.to(T,q,I),I+=q.duration;y.duration()<c&&y.to({},{duration:c-y.duration()})}}c||a.duration(c=y.duration())}else a.timeline=0;return p===!0&&!yn&&(Be=Ne(a),z.killTweensOf(T),Be=0),Ae(w,Ne(a),s),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(u||!c&&!m&&a._start===K(w._time)&&le(u)&&ka(Ne(a))&&w.data!=="nested")&&(a._tTime=-1e-8,a.render(Math.max(0,-h)||0)),_&&ir(Ne(a),_),a}var t=e.prototype;return t.render=function(n,s,r){var a=this._time,l=this._tDur,c=this._dur,h=n<0,u=n>l-ne&&!h?l:n<ne?0:n,d,p,m,f,_,g,w,T,y;if(!c)Ua(this,n,s,r);else if(u!==this._tTime||!n||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(d=u,T=this.timeline,this._repeat){if(f=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(f*100+n,s,r);if(d=K(u%f),u===l?(m=this._repeat,d=c):(_=K(u/f),m=~~_,m&&m===_?(d=c,m--):d>c&&(d=c)),g=this._yoyo&&m&1,g&&(y=this._yEase,d=c-d),_=It(this._tTime,f),d===a&&!r&&this._initted&&m===_)return this._tTime=u,this;m!==_&&(T&&this._yEase&&gr(T,g),this.vars.repeatRefresh&&!g&&!this._lock&&d!==f&&this._initted&&(this._lock=r=1,this.render(K(f*m),!0).invalidate()._lock=0))}if(!this._initted){if(nr(this,h?n:d,r,s,u))return this._tTime=0,this;if(a!==this._time&&!(r&&this.vars.repeatRefresh&&m!==_))return this;if(c!==this._dur)return this.render(n,s,r)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=w=(y||this._ease)(d/c),this._from&&(this.ratio=w=1-w),!a&&u&&!s&&!_&&(me(this,"onStart"),this._tTime!==u))return this;for(p=this._pt;p;)p.r(w,p.d),p=p._next;T&&T.render(n<0?n:T._dur*T._ease(d/this._dur),s,r)||this._startAt&&(this._zTime=n),this._onUpdate&&!s&&(h&&nn(this,n,s,r),me(this,"onUpdate")),this._repeat&&m!==_&&this.vars.onRepeat&&!s&&this.parent&&me(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(h&&!this._onUpdate&&nn(this,n,!0,!0),(n||!c)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&Je(this,1),!s&&!(h&&!a)&&(u||a||g)&&(me(this,u===l?"onComplete":"onReverseComplete",!0),this._prom&&!(u<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),o.prototype.invalidate.call(this,n)},t.resetTo=function(n,s,r,a,l){ni||pe.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||Rn(this,c),h=this._ease(c/this._dur),nl(this,n,s,r,a,h,c,l)?this.resetTo(n,s,r,a,1):(Ri(this,0),this.parent||er(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,s){if(s===void 0&&(s="all"),!n&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Kt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!te),this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(n,s,Be&&Be.vars.overwrite!==!0)._first||Kt(this),this.parent&&r!==this.timeline.totalDuration()&&Nt(this,this._dur*this.timeline._tDur/r,0,1),this}var a=this._targets,l=n?Te(n):a,c=this._ptLookup,h=this._pt,u,d,p,m,f,_,g;if((!s||s==="all")&&Ia(a,l))return s==="all"&&(this._pt=0),Kt(this);for(u=this._op=this._op||[],s!=="all"&&(J(s)&&(f={},ce(s,function(w){return f[w]=1}),s=f),s=sl(a,s)),g=a.length;g--;)if(~l.indexOf(a[g])){d=c[g],s==="all"?(u[g]=s,m=d,p={}):(p=u[g]=u[g]||{},m=s);for(f in m)_=d&&d[f],_&&((!("kill"in _.d)||_.d.kill(f)===!0)&&Ai(this,_,"_pt"),delete d[f]),p!=="all"&&(p[f]=1)}return this._initted&&!this._pt&&h&&Kt(this),this},e.to=function(n,s){return new e(n,s,arguments[2])},e.from=function(n,s){return Zt(1,arguments)},e.delayedCall=function(n,s,r,a){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:s,onReverseComplete:s,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:a})},e.fromTo=function(n,s,r){return Zt(2,arguments)},e.set=function(n,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(n,s)},e.killTweensOf=function(n,s,r){return z.killTweensOf(n,s,r)},e}(si);we(B.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ce("staggerTo,staggerFrom,staggerFromTo",function(o){B[o]=function(){var e=new re,t=rn.call(arguments,0);return t.splice(o==="staggerFromTo"?5:4,0,0),e[o].apply(e,t)}});var On=function(e,t,i){return e[t]=i},Mr=function(e,t,i){return e[t](i)},ol=function(e,t,i,n){return e[t](n.fp,i)},al=function(e,t,i){return e.setAttribute(t,i)},Ln=function(e,t){return j(e[t])?Mr:bn(e[t])&&e.setAttribute?al:On},Sr=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},ll=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Er=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},Cn=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},cl=function(e,t,i,n){for(var s=this._pt,r;s;)r=s._next,s.p===n&&s.modifier(e,t,i),s=r},hl=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?Ai(this,t,"_pt"):t.dep||(i=1),t=n;return!i},ul=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},vr=function(e){for(var t=e._pt,i,n,s,r;t;){for(i=t._next,n=s;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:r)?t._prev._next=t:s=t,(t._next=n)?n._prev=t:r=t,t=i}e._pt=s},he=function(){function o(t,i,n,s,r,a,l,c,h){this.t=i,this.s=s,this.c=r,this.p=n,this.r=a||Sr,this.d=l||this,this.set=c||On,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=o.prototype;return e.modifier=function(i,n,s){this.mSet=this.mSet||this.set,this.set=ul,this.m=i,this.mt=s,this.tween=n},o}();ce(En+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(o){return Sn[o]=1});ge.TweenMax=ge.TweenLite=B;ge.TimelineLite=ge.TimelineMax=re;z=new re({sortChildren:!1,defaults:Ct,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_e.stringFilter=mr;var mt=[],mi={},dl=[],us=0,fl=0,Vi=function(e){return(mi[e]||dl).map(function(t){return t()})},cn=function(){var e=Date.now(),t=[];e-us>2&&(Vi("matchMediaInit"),mt.forEach(function(i){var n=i.queries,s=i.conditions,r,a,l,c;for(a in n)r=ve.matchMedia(n[a]).matches,r&&(l=1),r!==s[a]&&(s[a]=r,c=1);c&&(i.revert(),l&&t.push(i))}),Vi("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(n){return i.add(null,n)})}),us=e,Vi("matchMedia"))},Ar=function(){function o(t,i){this.selector=i&&on(i),this.data=[],this._r=[],this.isReverted=!1,this.id=fl++,t&&this.add(t)}var e=o.prototype;return e.add=function(i,n,s){j(i)&&(s=n,n=i,i=j);var r=this,a=function(){var c=U,h=r.selector,u;return c&&c!==r&&c.data.push(r),s&&(r.selector=on(s)),U=r,u=n.apply(r,arguments),j(u)&&r._r.push(u),U=c,r.selector=h,r.isReverted=!1,u};return r.last=a,i===j?a(r,function(l){return r.add(null,l)}):i?r[i]=a:a},e.ignore=function(i){var n=U;U=null,i(this),U=n},e.getTweens=function(){var i=[];return this.data.forEach(function(n){return n instanceof o?i.push.apply(i,n.getTweens()):n instanceof B&&!(n.parent&&n.parent.data==="nested")&&i.push(n)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,n){var s=this;if(i?function(){for(var a=s.getTweens(),l=s.data.length,c;l--;)c=s.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return a.splice(a.indexOf(h),1)}));for(a.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,u){return u.g-h.g||-1/0}).forEach(function(h){return h.t.revert(i)}),l=s.data.length;l--;)c=s.data[l],c instanceof re?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof B)&&c.revert&&c.revert(i);s._r.forEach(function(h){return h(i,s)}),s.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),n)for(var r=mt.length;r--;)mt[r].id===this.id&&mt.splice(r,1)},e.revert=function(i){this.kill(i||{})},o}(),pl=function(){function o(t){this.contexts=[],this.scope=t,U&&U.data.push(this)}var e=o.prototype;return e.add=function(i,n,s){Le(i)||(i={matches:i});var r=new Ar(0,s||this.scope),a=r.conditions={},l,c,h;U&&!r.selector&&(r.selector=U.selector),this.contexts.push(r),n=r.add("onMatch",n),r.queries=i;for(c in i)c==="all"?h=1:(l=ve.matchMedia(i[c]),l&&(mt.indexOf(r)<0&&mt.push(r),(a[c]=l.matches)&&(h=1),l.addListener?l.addListener(cn):l.addEventListener("change",cn)));return h&&n(r,function(u){return r.add(null,u)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(n){return n.kill(i,!0)})},o}(),Ti={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return dr(n)})},timeline:function(e){return new re(e)},getTweensOf:function(e,t){return z.getTweensOf(e,t)},getProperty:function(e,t,i,n){J(e)&&(e=Te(e)[0]);var s=dt(e||{}).get,r=i?Js:Qs;return i==="native"&&(i=""),e&&(t?r((fe[t]&&fe[t].get||s)(e,t,i,n)):function(a,l,c){return r((fe[a]&&fe[a].get||s)(e,a,l,c))})},quickSetter:function(e,t,i){if(e=Te(e),e.length>1){var n=e.map(function(h){return de.quickSetter(h,t,i)}),s=n.length;return function(h){for(var u=s;u--;)n[u](h)}}e=e[0]||{};var r=fe[t],a=dt(e),l=a.harness&&(a.harness.aliases||{})[t]||t,c=r?function(h){var u=new r;Mt._pt=0,u.init(e,i?h+i:h,Mt,0,[e]),u.render(1,u),Mt._pt&&Cn(1,Mt)}:a.set(e,l);return r?c:function(h){return c(e,l,i?h+i:h,a,1)}},quickTo:function(e,t,i){var n,s=de.to(e,we((n={},n[t]="+=0.1",n.paused=!0,n.stagger=0,n),i||{})),r=function(l,c,h){return s.resetTo(t,l,c,h)};return r.tween=s,r},isTweening:function(e){return z.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=pt(e.ease,Ct.ease)),os(Ct,e||{})},config:function(e){return os(_e,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,r=e.extendTimeline;(n||"").split(",").forEach(function(a){return a&&!fe[a]&&!ge[a]&&ei(t+" effect requires "+a+" plugin.")}),Ui[t]=function(a,l,c){return i(Te(a),we(l||{},s),c)},r&&(re.prototype[t]=function(a,l,c){return this.add(Ui[t](a,Le(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){O[e]=pt(t)},parseEase:function(e,t){return arguments.length?pt(e,t):O},getById:function(e){return z.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new re(e),n,s;for(i.smoothChildTiming=le(e.smoothChildTiming),z.remove(i),i._dp=0,i._time=i._tTime=z._time,n=z._first;n;)s=n._next,(t||!(!n._dur&&n instanceof B&&n.vars.onComplete===n._targets[0]))&&Ae(i,n,n._start-n._delay),n=s;return Ae(z,i,0),i},context:function(e,t){return e?new Ar(e,t):U},matchMedia:function(e){return new pl(e)},matchMediaRefresh:function(){return mt.forEach(function(e){var t=e.conditions,i,n;for(n in t)t[n]&&(t[n]=!1,i=1);i&&e.revert()})||cn()},addEventListener:function(e,t){var i=mi[e]||(mi[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=mi[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:Xa,wrapYoyo:Wa,distribute:or,random:lr,snap:ar,normalize:Ka,getUnit:ie,clamp:ja,splitColor:fr,toArray:Te,selector:on,mapRange:hr,pipe:Ha,unitize:Ba,interpolate:Ya,shuffle:rr},install:Ws,effects:Ui,ticker:pe,updateRoot:re.updateRoot,plugins:fe,globalTimeline:z,core:{PropTween:he,globals:Ys,Tween:B,Timeline:re,Animation:si,getCache:dt,_removeLinkedListItem:Ai,reverting:function(){return te},context:function(e){return e&&U&&(U.data.push(e),e._ctx=U),U},suppressOverwrites:function(e){return yn=e}}};ce("to,from,fromTo,delayedCall,set,killTweensOf",function(o){return Ti[o]=B[o]});pe.add(re.updateRoot);Mt=Ti.to({},{duration:0});var ml=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},_l=function(e,t){var i=e._targets,n,s,r;for(n in t)for(s=i.length;s--;)r=e._ptLookup[s][n],r&&(r=r.d)&&(r._pt&&(r=ml(r,n)),r&&r.modifier&&r.modifier(t[n],e,i[s],n))},Hi=function(e,t){return{name:e,headless:1,rawVars:1,init:function(n,s,r){r._onInit=function(a){var l,c;if(J(s)&&(l={},ce(s,function(h){return l[h]=1}),s=l),t){l={};for(c in s)l[c]=t(s[c]);s=l}_l(a,s)}}}},de=Ti.registerPlugin({name:"attr",init:function(e,t,i,n,s){var r,a,l;this.tween=i;for(r in t)l=e.getAttribute(r)||"",a=this.add(e,"setAttribute",(l||0)+"",t[r],n,s,0,0,r),a.op=r,a.b=l,this._props.push(r)},render:function(e,t){for(var i=t._pt;i;)te?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Hi("roundProps",an),Hi("modifiers"),Hi("snap",ar))||Ti;B.version=re.version=de.version="3.13.0";Xs=1;Tn()&&kt();O.Power0;O.Power1;O.Power2;O.Power3;O.Power4;O.Linear;O.Quad;O.Cubic;O.Quart;O.Quint;O.Strong;O.Elastic;O.Back;O.SteppedEase;O.Bounce;O.Sine;O.Expo;O.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ds,Ke,Rt,Dn,ht,fs,In,gl=function(){return typeof window<"u"},Ge={},ct=180/Math.PI,Ot=Math.PI/180,bt=Math.atan2,ps=1e8,Nn=/([A-Z])/g,wl=/(left|right|width|margin|padding|x)/i,yl=/[\s,\(]\S/,Pe={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},hn=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},bl=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},Tl=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},xl=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Pr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Rr=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},Ml=function(e,t,i){return e.style[t]=i},Sl=function(e,t,i){return e.style.setProperty(t,i)},El=function(e,t,i){return e._gsap[t]=i},vl=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Al=function(e,t,i,n,s){var r=e._gsap;r.scaleX=r.scaleY=i,r.renderTransform(s,r)},Pl=function(e,t,i,n,s){var r=e._gsap;r[t]=i,r.renderTransform(s,r)},G="transform",ue=G+"Origin",Rl=function o(e,t){var i=this,n=this.target,s=n.style,r=n._gsap;if(e in Ge&&s){if(this.tfm=this.tfm||{},e!=="transform")e=Pe[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return i.tfm[a]=ke(n,a)}):this.tfm[e]=r.x?r[e]:ke(n,e),e===ue&&(this.tfm.zOrigin=r.zOrigin);else return Pe.transform.split(",").forEach(function(a){return o.call(i,a,t)});if(this.props.indexOf(G)>=0)return;r.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(ue,t,"")),e=G}(s||t)&&this.props.push(e,t,s[e])},Or=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Ol=function(){var e=this.props,t=this.target,i=t.style,n=t._gsap,s,r;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(Nn,"-$1").toLowerCase());if(this.tfm){for(r in this.tfm)n[r]=this.tfm[r];n.svg&&(n.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=In(),(!s||!s.isStart)&&!i[G]&&(Or(i),n.zOrigin&&i[ue]&&(i[ue]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},Lr=function(e,t){var i={target:e,props:[],revert:Ol,save:Rl};return e._gsap||de.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(n){return i.save(n)}),i},Cr,un=function(e,t){var i=Ke.createElementNS?Ke.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ke.createElement(e);return i&&i.style?i:Ke.createElement(e)},xe=function o(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(Nn,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&o(e,Ft(t)||t,1)||""},ms="O,Moz,ms,Ms,Webkit".split(","),Ft=function(e,t,i){var n=t||ht,s=n.style,r=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);r--&&!(ms[r]+e in s););return r<0?null:(r===3?"ms":r>=0?ms[r]:"")+e},dn=function(){gl()&&window.document&&(ds=window,Ke=ds.document,Rt=Ke.documentElement,ht=un("div")||{style:{}},un("div"),G=Ft(G),ue=G+"Origin",ht.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Cr=!!Ft("perspective"),In=de.core.reverting,Dn=1)},_s=function(e){var t=e.ownerSVGElement,i=un("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=e.cloneNode(!0),s;n.style.display="block",i.appendChild(n),Rt.appendChild(i);try{s=n.getBBox()}catch{}return i.removeChild(n),Rt.removeChild(i),s},gs=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Dr=function(e){var t,i;try{t=e.getBBox()}catch{t=_s(e),i=1}return t&&(t.width||t.height)||i||(t=_s(e)),t&&!t.width&&!t.x&&!t.y?{x:+gs(e,["x","cx","x1"])||0,y:+gs(e,["y","cy","y1"])||0,width:0,height:0}:t},Ir=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Dr(e))},_t=function(e,t){if(t){var i=e.style,n;t in Ge&&t!==ue&&(t=G),i.removeProperty?(n=t.substr(0,2),(n==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(n==="--"?t:t.replace(Nn,"-$1").toLowerCase())):i.removeAttribute(t)}},Xe=function(e,t,i,n,s,r){var a=new he(e._pt,t,i,0,1,r?Rr:Pr);return e._pt=a,a.b=n,a.e=s,e._props.push(i),a},ws={deg:1,rad:1,turn:1},Ll={grid:1,flex:1},et=function o(e,t,i,n){var s=parseFloat(i)||0,r=(i+"").trim().substr((s+"").length)||"px",a=ht.style,l=wl.test(t),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),u=100,d=n==="px",p=n==="%",m,f,_,g;if(n===r||!s||ws[n]||ws[r])return s;if(r!=="px"&&!d&&(s=o(e,t,i,"px")),g=e.getCTM&&Ir(e),(p||r==="%")&&(Ge[t]||~t.indexOf("adius")))return m=g?e.getBBox()[l?"width":"height"]:e[h],V(p?s/m*u:s/100*m);if(a[l?"width":"height"]=u+(d?r:n),f=n!=="rem"&&~t.indexOf("adius")||n==="em"&&e.appendChild&&!c?e:e.parentNode,g&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===Ke||!f.appendChild)&&(f=Ke.body),_=f._gsap,_&&p&&_.width&&l&&_.time===pe.time&&!_.uncache)return V(s/_.width*u);if(p&&(t==="height"||t==="width")){var w=e.style[t];e.style[t]=u+n,m=e[h],w?e.style[t]=w:_t(e,t)}else(p||r==="%")&&!Ll[xe(f,"display")]&&(a.position=xe(e,"position")),f===e&&(a.position="static"),f.appendChild(ht),m=ht[h],f.removeChild(ht),a.position="absolute";return l&&p&&(_=dt(f),_.time=pe.time,_.width=f[h]),V(d?m*s/u:m&&s?u/m*s:0)},ke=function(e,t,i,n){var s;return Dn||dn(),t in Pe&&t!=="transform"&&(t=Pe[t],~t.indexOf(",")&&(t=t.split(",")[0])),Ge[t]&&t!=="transform"?(s=oi(e,n),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:Mi(xe(e,ue))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||n||~(s+"").indexOf("calc("))&&(s=xi[t]&&xi[t](e,t,i)||xe(e,t)||$s(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?et(e,t,s,i)+i:s},Cl=function(e,t,i,n){if(!i||i==="none"){var s=Ft(t,e,1),r=s&&xe(e,s,1);r&&r!==i?(t=s,i=r):t==="borderColor"&&(i=xe(e,"borderTopColor"))}var a=new he(this._pt,e.style,t,0,1,Er),l=0,c=0,h,u,d,p,m,f,_,g,w,T,y,b;if(a.b=i,a.e=n,i+="",n+="",n.substring(0,6)==="var(--"&&(n=xe(e,n.substring(4,n.indexOf(")")))),n==="auto"&&(f=e.style[t],e.style[t]=n,n=xe(e,t)||n,f?e.style[t]=f:_t(e,t)),h=[i,n],mr(h),i=h[0],n=h[1],d=i.match(xt)||[],b=n.match(xt)||[],b.length){for(;u=xt.exec(n);)_=u[0],w=n.substring(l,u.index),m?m=(m+1)%5:(w.substr(-5)==="rgba("||w.substr(-5)==="hsla(")&&(m=1),_!==(f=d[c++]||"")&&(p=parseFloat(f)||0,y=f.substr((p+"").length),_.charAt(1)==="="&&(_=Pt(p,_)+y),g=parseFloat(_),T=_.substr((g+"").length),l=xt.lastIndex-T.length,T||(T=T||_e.units[t]||y,l===n.length&&(n+=T,a.e+=T)),y!==T&&(p=et(e,t,f,T)||0),a._pt={_next:a._pt,p:w||c===1?w:",",s:p,c:g-p,m:m&&m<4||t==="zIndex"?Math.round:0});a.c=l<n.length?n.substring(l,n.length):""}else a.r=t==="display"&&n==="none"?Rr:Pr;return Bs.test(n)&&(a.e=0),this._pt=a,a},ys={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Dl=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=ys[i]||i,t[1]=ys[n]||n,t.join(" ")},Il=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,s=t.u,r=i._gsap,a,l,c;if(s==="all"||s===!0)n.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)a=s[c],Ge[a]&&(l=1,a=a==="transformOrigin"?ue:G),_t(i,a);l&&(_t(i,G),r&&(r.svg&&i.removeAttribute("transform"),n.scale=n.rotate=n.translate="none",oi(i,1),r.uncache=1,Or(n)))}},xi={clearProps:function(e,t,i,n,s){if(s.data!=="isFromStart"){var r=e._pt=new he(e._pt,t,i,0,0,Il);return r.u=n,r.pr=-10,r.tween=s,e._props.push(i),1}}},ri=[1,0,0,1,0,0],Nr={},kr=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},bs=function(e){var t=xe(e,G);return kr(t)?ri:t.substr(7).match(Hs).map(V)},kn=function(e,t){var i=e._gsap||dt(e),n=e.style,s=bs(e),r,a,l,c;return i.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?ri:s):(s===ri&&!e.offsetParent&&e!==Rt&&!i.svg&&(l=n.display,n.display="block",r=e.parentNode,(!r||!e.offsetParent&&!e.getBoundingClientRect().width)&&(c=1,a=e.nextElementSibling,Rt.appendChild(e)),s=bs(e),l?n.display=l:_t(e,"display"),c&&(a?r.insertBefore(e,a):r?r.appendChild(e):Rt.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},fn=function(e,t,i,n,s,r){var a=e._gsap,l=s||kn(e,!0),c=a.xOrigin||0,h=a.yOrigin||0,u=a.xOffset||0,d=a.yOffset||0,p=l[0],m=l[1],f=l[2],_=l[3],g=l[4],w=l[5],T=t.split(" "),y=parseFloat(T[0])||0,b=parseFloat(T[1])||0,S,M,E,x;i?l!==ri&&(M=p*_-m*f)&&(E=y*(_/M)+b*(-f/M)+(f*w-_*g)/M,x=y*(-m/M)+b*(p/M)-(p*w-m*g)/M,y=E,b=x):(S=Dr(e),y=S.x+(~T[0].indexOf("%")?y/100*S.width:y),b=S.y+(~(T[1]||T[0]).indexOf("%")?b/100*S.height:b)),n||n!==!1&&a.smooth?(g=y-c,w=b-h,a.xOffset=u+(g*p+w*f)-g,a.yOffset=d+(g*m+w*_)-w):a.xOffset=a.yOffset=0,a.xOrigin=y,a.yOrigin=b,a.smooth=!!n,a.origin=t,a.originIsAbsolute=!!i,e.style[ue]="0px 0px",r&&(Xe(r,a,"xOrigin",c,y),Xe(r,a,"yOrigin",h,b),Xe(r,a,"xOffset",u,a.xOffset),Xe(r,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",y+" "+b)},oi=function(e,t){var i=e._gsap||new yr(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,s=i.scaleX<0,r="px",a="deg",l=getComputedStyle(e),c=xe(e,ue)||"0",h,u,d,p,m,f,_,g,w,T,y,b,S,M,E,x,P,F,I,N,ee,q,H,$,Me,ci,jt,Vt,st,Fn,De,rt;return h=u=d=f=_=g=w=T=y=0,p=m=1,i.svg=!!(e.getCTM&&Ir(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(n[G]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[G]!=="none"?l[G]:"")),n.scale=n.rotate=n.translate="none"),M=kn(e,i.svg),i.svg&&(i.uncache?(Me=e.getBBox(),c=i.xOrigin-Me.x+"px "+(i.yOrigin-Me.y)+"px",$=""):$=!t&&e.getAttribute("data-svg-origin"),fn(e,$||c,!!$||i.originIsAbsolute,i.smooth!==!1,M)),b=i.xOrigin||0,S=i.yOrigin||0,M!==ri&&(F=M[0],I=M[1],N=M[2],ee=M[3],h=q=M[4],u=H=M[5],M.length===6?(p=Math.sqrt(F*F+I*I),m=Math.sqrt(ee*ee+N*N),f=F||I?bt(I,F)*ct:0,w=N||ee?bt(N,ee)*ct+f:0,w&&(m*=Math.abs(Math.cos(w*Ot))),i.svg&&(h-=b-(b*F+S*N),u-=S-(b*I+S*ee))):(rt=M[6],Fn=M[7],jt=M[8],Vt=M[9],st=M[10],De=M[11],h=M[12],u=M[13],d=M[14],E=bt(rt,st),_=E*ct,E&&(x=Math.cos(-E),P=Math.sin(-E),$=q*x+jt*P,Me=H*x+Vt*P,ci=rt*x+st*P,jt=q*-P+jt*x,Vt=H*-P+Vt*x,st=rt*-P+st*x,De=Fn*-P+De*x,q=$,H=Me,rt=ci),E=bt(-N,st),g=E*ct,E&&(x=Math.cos(-E),P=Math.sin(-E),$=F*x-jt*P,Me=I*x-Vt*P,ci=N*x-st*P,De=ee*P+De*x,F=$,I=Me,N=ci),E=bt(I,F),f=E*ct,E&&(x=Math.cos(E),P=Math.sin(E),$=F*x+I*P,Me=q*x+H*P,I=I*x-F*P,H=H*x-q*P,F=$,q=Me),_&&Math.abs(_)+Math.abs(f)>359.9&&(_=f=0,g=180-g),p=V(Math.sqrt(F*F+I*I+N*N)),m=V(Math.sqrt(H*H+rt*rt)),E=bt(q,H),w=Math.abs(E)>2e-4?E*ct:0,y=De?1/(De<0?-De:De):0),i.svg&&($=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!kr(xe(e,G)),$&&e.setAttribute("transform",$))),Math.abs(w)>90&&Math.abs(w)<270&&(s?(p*=-1,w+=f<=0?180:-180,f+=f<=0?180:-180):(m*=-1,w+=w<=0?180:-180)),t=t||i.uncache,i.x=h-((i.xPercent=h&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+r,i.y=u-((i.yPercent=u&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-u)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+r,i.z=d+r,i.scaleX=V(p),i.scaleY=V(m),i.rotation=V(f)+a,i.rotationX=V(_)+a,i.rotationY=V(g)+a,i.skewX=w+a,i.skewY=T+a,i.transformPerspective=y+r,(i.zOrigin=parseFloat(c.split(" ")[2])||!t&&i.zOrigin||0)&&(n[ue]=Mi(c)),i.xOffset=i.yOffset=0,i.force3D=_e.force3D,i.renderTransform=i.svg?kl:Cr?Fr:Nl,i.uncache=0,i},Mi=function(e){return(e=e.split(" "))[0]+" "+e[1]},Bi=function(e,t,i){var n=ie(t);return V(parseFloat(t)+parseFloat(et(e,"x",i+"px",n)))+n},Nl=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Fr(e,t)},at="0deg",Bt="0px",lt=") ",Fr=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,r=i.x,a=i.y,l=i.z,c=i.rotation,h=i.rotationY,u=i.rotationX,d=i.skewX,p=i.skewY,m=i.scaleX,f=i.scaleY,_=i.transformPerspective,g=i.force3D,w=i.target,T=i.zOrigin,y="",b=g==="auto"&&e&&e!==1||g===!0;if(T&&(u!==at||h!==at)){var S=parseFloat(h)*Ot,M=Math.sin(S),E=Math.cos(S),x;S=parseFloat(u)*Ot,x=Math.cos(S),r=Bi(w,r,M*x*-T),a=Bi(w,a,-Math.sin(S)*-T),l=Bi(w,l,E*x*-T+T)}_!==Bt&&(y+="perspective("+_+lt),(n||s)&&(y+="translate("+n+"%, "+s+"%) "),(b||r!==Bt||a!==Bt||l!==Bt)&&(y+=l!==Bt||b?"translate3d("+r+", "+a+", "+l+") ":"translate("+r+", "+a+lt),c!==at&&(y+="rotate("+c+lt),h!==at&&(y+="rotateY("+h+lt),u!==at&&(y+="rotateX("+u+lt),(d!==at||p!==at)&&(y+="skew("+d+", "+p+lt),(m!==1||f!==1)&&(y+="scale("+m+", "+f+lt),w.style[G]=y||"translate(0, 0)"},kl=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,r=i.x,a=i.y,l=i.rotation,c=i.skewX,h=i.skewY,u=i.scaleX,d=i.scaleY,p=i.target,m=i.xOrigin,f=i.yOrigin,_=i.xOffset,g=i.yOffset,w=i.forceCSS,T=parseFloat(r),y=parseFloat(a),b,S,M,E,x;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=Ot,c*=Ot,b=Math.cos(l)*u,S=Math.sin(l)*u,M=Math.sin(l-c)*-d,E=Math.cos(l-c)*d,c&&(h*=Ot,x=Math.tan(c-h),x=Math.sqrt(1+x*x),M*=x,E*=x,h&&(x=Math.tan(h),x=Math.sqrt(1+x*x),b*=x,S*=x)),b=V(b),S=V(S),M=V(M),E=V(E)):(b=u,E=d,S=M=0),(T&&!~(r+"").indexOf("px")||y&&!~(a+"").indexOf("px"))&&(T=et(p,"x",r,"px"),y=et(p,"y",a,"px")),(m||f||_||g)&&(T=V(T+m-(m*b+f*M)+_),y=V(y+f-(m*S+f*E)+g)),(n||s)&&(x=p.getBBox(),T=V(T+n/100*x.width),y=V(y+s/100*x.height)),x="matrix("+b+","+S+","+M+","+E+","+T+","+y+")",p.setAttribute("transform",x),w&&(p.style[G]=x)},Fl=function(e,t,i,n,s){var r=360,a=J(s),l=parseFloat(s)*(a&&~s.indexOf("rad")?ct:1),c=l-n,h=n+c+"deg",u,d;return a&&(u=s.split("_")[1],u==="short"&&(c%=r,c!==c%(r/2)&&(c+=c<0?r:-360)),u==="cw"&&c<0?c=(c+r*ps)%r-~~(c/r)*r:u==="ccw"&&c>0&&(c=(c-r*ps)%r-~~(c/r)*r)),e._pt=d=new he(e._pt,t,i,n,c,bl),d.e=h,d.u="deg",e._props.push(i),d},Ts=function(e,t){for(var i in t)e[i]=t[i];return e},Ul=function(e,t,i){var n=Ts({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",r=i.style,a,l,c,h,u,d,p,m;n.svg?(c=i.getAttribute("transform"),i.setAttribute("transform",""),r[G]=t,a=oi(i,1),_t(i,G),i.setAttribute("transform",c)):(c=getComputedStyle(i)[G],r[G]=t,a=oi(i,1),r[G]=c);for(l in Ge)c=n[l],h=a[l],c!==h&&s.indexOf(l)<0&&(p=ie(c),m=ie(h),u=p!==m?et(i,l,c,m):parseFloat(c),d=parseFloat(h),e._pt=new he(e._pt,a,l,u,d-u,hn),e._pt.u=m||0,e._props.push(l));Ts(a,n)};ce("padding,margin,Width,Radius",function(o,e){var t="Top",i="Right",n="Bottom",s="Left",r=(e<3?[t,i,n,s]:[t+s,t+i,n+i,n+s]).map(function(a){return e<2?o+a:"border"+a+o});xi[e>1?"border"+o:o]=function(a,l,c,h,u){var d,p;if(arguments.length<4)return d=r.map(function(m){return ke(a,m,c)}),p=d.join(" "),p.split(d[0]).length===5?d[0]:p;d=(h+"").split(" "),p={},r.forEach(function(m,f){return p[m]=d[f]=d[f]||d[(f-1)/2|0]}),a.init(l,p,u)}});var Ur={name:"css",register:dn,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var r=this._props,a=e.style,l=i.vars.startAt,c,h,u,d,p,m,f,_,g,w,T,y,b,S,M,E;Dn||dn(),this.styles=this.styles||Lr(e),E=this.styles.props,this.tween=i;for(f in t)if(f!=="autoRound"&&(h=t[f],!(fe[f]&&br(f,t,i,n,e,s)))){if(p=typeof h,m=xi[f],p==="function"&&(h=h.call(i,n,e,s),p=typeof h),p==="string"&&~h.indexOf("random(")&&(h=ii(h)),m)m(this,e,f,h,i)&&(M=1);else if(f.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(f)+"").trim(),h+="",$e.lastIndex=0,$e.test(c)||(_=ie(c),g=ie(h)),g?_!==g&&(c=et(e,f,c,g)+g):_&&(h+=_),this.add(a,"setProperty",c,h,n,s,0,0,f),r.push(f),E.push(f,0,a[f]);else if(p!=="undefined"){if(l&&f in l?(c=typeof l[f]=="function"?l[f].call(i,n,e,s):l[f],J(c)&&~c.indexOf("random(")&&(c=ii(c)),ie(c+"")||c==="auto"||(c+=_e.units[f]||ie(ke(e,f))||""),(c+"").charAt(1)==="="&&(c=ke(e,f))):c=ke(e,f),d=parseFloat(c),w=p==="string"&&h.charAt(1)==="="&&h.substr(0,2),w&&(h=h.substr(2)),u=parseFloat(h),f in Pe&&(f==="autoAlpha"&&(d===1&&ke(e,"visibility")==="hidden"&&u&&(d=0),E.push("visibility",0,a.visibility),Xe(this,a,"visibility",d?"inherit":"hidden",u?"inherit":"hidden",!u)),f!=="scale"&&f!=="transform"&&(f=Pe[f],~f.indexOf(",")&&(f=f.split(",")[0]))),T=f in Ge,T){if(this.styles.save(f),p==="string"&&h.substring(0,6)==="var(--"&&(h=xe(e,h.substring(4,h.indexOf(")"))),u=parseFloat(h)),y||(b=e._gsap,b.renderTransform&&!t.parseTransform||oi(e,t.parseTransform),S=t.smoothOrigin!==!1&&b.smooth,y=this._pt=new he(this._pt,a,G,0,1,b.renderTransform,b,0,-1),y.dep=1),f==="scale")this._pt=new he(this._pt,b,"scaleY",b.scaleY,(w?Pt(b.scaleY,w+u):u)-b.scaleY||0,hn),this._pt.u=0,r.push("scaleY",f),f+="X";else if(f==="transformOrigin"){E.push(ue,0,a[ue]),h=Dl(h),b.svg?fn(e,h,0,S,0,this):(g=parseFloat(h.split(" ")[2])||0,g!==b.zOrigin&&Xe(this,b,"zOrigin",b.zOrigin,g),Xe(this,a,f,Mi(c),Mi(h)));continue}else if(f==="svgOrigin"){fn(e,h,1,S,0,this);continue}else if(f in Nr){Fl(this,b,f,d,w?Pt(d,w+h):h);continue}else if(f==="smoothOrigin"){Xe(this,b,"smooth",b.smooth,h);continue}else if(f==="force3D"){b[f]=h;continue}else if(f==="transform"){Ul(this,h,e);continue}}else f in a||(f=Ft(f)||f);if(T||(u||u===0)&&(d||d===0)&&!yl.test(h)&&f in a)_=(c+"").substr((d+"").length),u||(u=0),g=ie(h)||(f in _e.units?_e.units[f]:_),_!==g&&(d=et(e,f,c,g)),this._pt=new he(this._pt,T?b:a,f,d,(w?Pt(d,w+u):u)-d,!T&&(g==="px"||f==="zIndex")&&t.autoRound!==!1?xl:hn),this._pt.u=g||0,_!==g&&g!=="%"&&(this._pt.b=c,this._pt.r=Tl);else if(f in a)Cl.call(this,e,f,c,w?w+h:h);else if(f in e)this.add(e,f,c||e[f],w?w+h:h,n,s);else if(f!=="parseTransform"){Mn(f,h);continue}T||(f in a?E.push(f,0,a[f]):typeof e[f]=="function"?E.push(f,2,e[f]()):E.push(f,1,c||e[f])),r.push(f)}}M&&vr(this)},render:function(e,t){if(t.tween._time||!In())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:ke,aliases:Pe,getSetter:function(e,t,i){var n=Pe[t];return n&&n.indexOf(",")<0&&(t=n),t in Ge&&t!==ue&&(e._gsap.x||ke(e,"x"))?i&&fs===i?t==="scale"?vl:El:(fs=i||{})&&(t==="scale"?Al:Pl):e.style&&!bn(e.style[t])?Ml:~t.indexOf("-")?Sl:Ln(e,t)},core:{_removeProperty:_t,_getMatrix:kn}};de.utils.checkPrefix=Ft;de.core.getStyleSaver=Lr;(function(o,e,t,i){var n=ce(o+","+e+","+t,function(s){Ge[s]=1});ce(e,function(s){_e.units[s]="deg",Nr[s]=1}),Pe[n[13]]=o+","+e,ce(i,function(s){var r=s.split(":");Pe[r[1]]=n[r[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ce("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(o){_e.units[o]="px"});de.registerPlugin(Ur);var pn=de.registerPlugin(Ur)||de;pn.core.Tween;function zl(o){if(o.eccentricity<0||o.eccentricity>=1)throw new Error(`Invalid eccentricity: ${o.eccentricity}. Must be 0 ≤ e < 1`);const t=o.semiMajorAxis*(Y/X)*(1-o.eccentricity)-Y;if(t<100)throw new Error(`Perigee altitude too low: ${t.toFixed(1)} km. Minimum is 100 km`);(o.beamwidth<0||o.beamwidth>180)&&o.beamwidth!==0&&console.warn(`Invalid beamwidth: ${o.beamwidth}°. Must be 0-180°`)}function Ze(o,e,t=1e-8,i=50){if(e<0||e>=1)throw new Error(`Invalid eccentricity for Kepler solver: ${e}`);o=(o%(2*Math.PI)+2*Math.PI)%(2*Math.PI);let n;e<.8?n=o:n=o+e*Math.sin(o)/(1-Math.sin(o+e)+Math.sin(o));for(let s=0;s<i;s++){const r=Math.sin(n),a=Math.cos(n),l=n-e*r-o,c=1-e*a,h=l/c;if(n-=h,Math.abs(h)<t)return n}return console.warn(`Kepler equation did not converge for M=${o.toFixed(6)}, e=${e.toFixed(6)} after ${i} iterations. Final error: ${Math.abs(n-e*Math.sin(n)-o).toFixed(8)}`),n}function Qe(o,e){const t=Math.sqrt((1+e)/(1-e))*Math.tan(o/2);return 2*Math.atan(t)}function tt(o,e){const t=Math.sqrt((1-e)/(1+e))*Math.tan(o/2);return 2*Math.atan(t)}function it(o,e){return o-e*Math.sin(o)}function zr(o,e,t,i=1){try{zl(o)}catch(T){console.warn("Orbital parameter validation warning:",T.message)}const n=o.semiMajorAxis*(Y/i),s=o.eccentricity,r=o.inclinationRad,a=o.argPerigeeRad,l=Ze(e,s),c=Qe(l,s),h=n*(1-s*s)/(1+s*Math.cos(c)),u=h*Math.cos(c),d=h*Math.sin(c),p=new R(u,d,0),m=new Se,f=new Se().makeRotationZ(a),_=new Se().makeRotationX(r),g=new Se().makeRotationZ(t);m.multiply(g).multiply(_).multiply(f),p.applyMatrix4(m);const w=new R(p.x/Y*i,p.z/Y*i,-p.y/Y*i);return{x:w.x,y:w.y,z:w.z}}function Oi(o,e,t=0){if(o<=Y)throw new Error(`Invalid semi-major axis: ${o} km. Must be greater than Earth's radius.`);if(e<0||e>=1)throw new Error(`Invalid eccentricity: ${e}`);const i=o*(1-e*e)/(1+e*Math.cos(t)),n=2*Math.PI*Math.sqrt(Math.pow(o,3)/qi),s=Math.sqrt(qi*(2/i-1/o));return{orbitalPeriod:n,orbitalVelocity:s}}function xs(o,e){const t=o.params.semiMajorAxis*(Y/X),i=o.params.eccentricity,n=o.params.inclinationRad,s=Math.sqrt(qi/Math.pow(t,3)),r=t*(1-i*i),a=1.5*Eo*Math.pow(Y/r,2)*s,l=-a*Math.cos(n),c=a*(2.5*Math.pow(Math.sin(n),2)-2),h=.5*a*Math.sqrt(1-i*i)*(3*Math.pow(Math.cos(n),2)-1);o.currentRAAN=o.initialRAAN+l*e,o.currentArgPerigee=o.initialArgPerigee+c*e,o.currentMeanAnomaly=o.initialMeanAnomaly+(s+h)*e,o.currentRAAN=(o.currentRAAN%(2*Math.PI)+2*Math.PI)%(2*Math.PI),o.currentArgPerigee=(o.currentArgPerigee%(2*Math.PI)+2*Math.PI)%(2*Math.PI),o.currentMeanAnomaly=(o.currentMeanAnomaly%(2*Math.PI)+2*Math.PI)%(2*Math.PI),o.params.argPerigeeRad=o.currentArgPerigee}class Gl{constructor(){this.baseEpochUTC=0,this.baseGMST=0,this.lastCalculatedTime=0,this.rotationOffset=0,this.maxAccumulationTime=3600}initialize(e){this.baseEpochUTC=e,this.baseGMST=Wn(new Date(e)),this.lastCalculatedTime=0,this.rotationOffset=0,console.log(`Earth rotation precision manager initialized: epoch=${new Date(e).toISOString()}`)}getRotationAngle(e){e-this.lastCalculatedTime>this.maxAccumulationTime&&this.resetAccumulation(e);const i=(e-this.lastCalculatedTime)*_i;return this.rotationOffset=(this.rotationOffset+i)%(2*Math.PI),this.lastCalculatedTime=e,((this.baseGMST+this.rotationOffset)%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}peekRotationAngle(e){return((this.baseGMST+e*_i)%(2*Math.PI)+2*Math.PI)%(2*Math.PI)}resetAccumulation(e){const t=this.baseEpochUTC+e*1e3;this.baseGMST=Wn(new Date(t)),this.baseEpochUTC=t,this.lastCalculatedTime=0,this.rotationOffset=0,console.log(`Earth rotation reset at t=${e}s to prevent precision loss`)}}const wt=new Gl;window.earthRotationManager=wt;let k,L,Z,A,Re,We,Ut,St,Ve,Et=new R;window.activeSatellites=new Map;window.activeGroundStations=new Map;window.selectedSatelliteId=null;window.selectedGroundStationId=null;window.isAnimating=!1;window.totalSimulatedTime=0;window.gsapAnimating=!1;window.initialEarthRotationOffset=0;window.currentEpochUTC=new Date().getTime();window.currentSpeedMultiplier=1;window.EARTH_ANGULAR_VELOCITY_RAD_PER_SEC=_i;window.is2DViewActive=!1;window.calculateDerivedOrbitalParameters=Oi;window.EarthRadius=Y;window.DEG2RAD=Q;window.SCENE_EARTH_RADIUS=X;window.updateSunDirection=zt;let Si=!1,Fe=null,Ms=performance.now();window.labelVisibilityEnabled=!0;window.proximityLabelsEnabled=!1;window.labelProximityDistance=2;window.maxVisibleLabels=10;window.nadirLinesEnabled=!0;window.gsSatLinkLines=new Map;function jl(){const o=document.getElementById("earth-container");if(!o){console.error("Critical: #earth-container not found.");return}Z=new wo({antialias:!0}),Z.setSize(o.offsetWidth,o.offsetHeight),Z.toneMapping=yo,Z.outputColorSpace=Lt,Z.setPixelRatio(window.devicePixelRatio),window.labelRenderer=new xa,labelRenderer.setSize(o.clientWidth,o.clientHeight),labelRenderer.domElement.style.position="absolute",labelRenderer.domElement.style.top="0",labelRenderer.domElement.style.pointerEvents="none",o.style.position="relative",o.appendChild(Z.domElement),o.appendChild(labelRenderer.domElement),L=new bo,k=new Ds(75,o.offsetWidth/o.offsetHeight,1e-4,1e3),k.position.z=2.5,A=new Po(k,Z.domElement),A.minDistance=1.2,A.maxDistance=10,A.enablePan=!1,A.enableDamping=!0,A.dampingFactor=.05,Re=new di,L.add(Re);const e=new _n,t=e.load("/textures/Earth_DayMap.jpg"),i=e.load("/textures/Earth_NightMap.jpg"),n=e.load("/textures/Earth_Specular.jpg"),s=e.load("/textures/earthbump10k.jpg"),r=e.load("/textures/Earth_Clouds.jpg"),a=new qt(X,256,256),l=new Kn({uniforms:{uEarthDayMap:{value:t},uEarthNightMap:{value:i},uEarthSpecularMap:{value:n},uEarthBumpMap:{value:s},uSunDirection:{value:Et},uTime:{value:0},uCameraPosition:{value:k.position},bumpScale:{value:.02},shininess:{value:1500}},vertexShader:`
            varying vec2 vUv;
            varying vec3 vWorldNormal;
            varying vec3 vWorldPosition;
            void main() {
                vUv = uv;
                vWorldNormal = normalize(mat3(modelMatrix) * normal);
                vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
            }
        `,fragmentShader:`
            uniform sampler2D uEarthDayMap;
            uniform sampler2D uEarthNightMap;
            uniform sampler2D uEarthSpecularMap;
            uniform sampler2D uEarthBumpMap;
            uniform vec3 uSunDirection;
            uniform vec3 uCameraPosition;
            uniform float bumpScale;
            uniform float shininess;
            varying vec2 vUv;
            varying vec3 vWorldNormal;
            varying vec3 vWorldPosition;
            void main() {
                vec4 dayColor = texture2D(uEarthDayMap, vUv);
                vec4 nightColor = texture2D(uEarthNightMap, vUv);
                vec3 specularMap = texture2D(uEarthSpecularMap, vUv).rgb;
                vec3 normalMap = texture2D(uEarthBumpMap, vUv).rgb * 2.0 - 1.0;
                vec3 perturbedNormal = normalize(vWorldNormal + normalMap * bumpScale);
                vec3 lightDir = normalize(uSunDirection);
                float NdotL = dot(perturbedNormal, lightDir);
                float dayNightFactor = smoothstep(-0.05, 0.05, NdotL);
                vec3 baseColor = mix(nightColor.rgb, dayColor.rgb, dayNightFactor);
                vec3 viewDir = normalize(uCameraPosition - vWorldPosition);
                vec3 reflectDir = reflect(-lightDir, perturbedNormal);
                float specular = pow(max(dot(viewDir, reflectDir), 0.0), shininess);
                vec3 specularColor = specularMap * specular * dayNightFactor * 0.4;
                gl_FragColor = vec4(baseColor + specularColor, 1.0);
            }
        `,transparent:!1,side:Yi,depthWrite:!0,depthTest:!0,alphaTest:0,blending:To});We=new ut(a,l),Re.add(We);const c=new qt(X*1.004,256,256);Ut=new ut(c,new gn({map:r,transparent:!0,opacity:.25,blending:Xn,side:Yi,depthWrite:!1,depthTest:!0})),Re.add(Ut);function h(){const d=new qt(X*1.01,256,256),p=new Kn({uniforms:{uSunDirection:{value:Et},uCameraPosition:{value:k.position},uGlowColor:{value:new Ee(5089023)},uRimColor:{value:new Ee(8900331)}},vertexShader:`
                varying vec3 vWorldNormal;
                varying vec3 vViewDirection;
                void main() {
                    vec4 worldPosition = modelMatrix * vec4(position, 1.0);
                    vWorldNormal = normalize(mat3(modelMatrix) * normal);
                    vViewDirection = normalize(cameraPosition - worldPosition.xyz);
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,fragmentShader:`
                uniform vec3 uSunDirection;
                uniform vec3 uGlowColor;
                uniform vec3 uRimColor;
                varying vec3 vWorldNormal;
                varying vec3 vViewDirection;
                void main() {
                    float fresnel = 1.0 - abs(dot(vViewDirection, vWorldNormal));
                    fresnel = pow(fresnel, 2.5);
                    float sunInfluence = smoothstep(-0.5, 0.5, dot(vWorldNormal, normalize(uSunDirection)));
                    vec3 glowColor = mix(uGlowColor * 0.3, uRimColor, sunInfluence);
                    float intensity = fresnel * (0.2 + 0.8 * sunInfluence);
                    gl_FragColor = vec4(glowColor, intensity * 0.6);
                }
            `,transparent:!0,side:Mo,blending:Xn,depthWrite:!1,depthTest:!0});return new ut(d,p)}St=h(),L.add(St),L.add(Sa({numStars:4e3})),Ve=new As(16777215,1),Ve.castShadow=!0,Ve.shadow.mapSize.width=1024,Ve.shadow.mapSize.height=1024,Ve.shadow.camera.near=.5,Ve.shadow.camera.far=500,L.add(Ve);const u=new Ns(3355443,1);L.add(u),Z.shadowMap.enabled=!0,Z.shadowMap.type=xo}function zt(o){const e=new Date(window.currentEpochUTC+o*1e3),{ra:t,dec:i}=vo(e),n=Math.cos(t),s=Math.sin(t),r=Math.cos(i),a=Math.sin(i),l=r*n,c=r*s,h=a,u=l,d=h,p=-c;Et.set(u,d,p).normalize(),Ve.position.copy(Et).multiplyScalar(10),We&&We.material.uniforms&&(We.material.uniforms.uSunDirection.value.copy(Et),We.material.uniforms.uCameraPosition.value.copy(k.position)),St&&St.material.uniforms&&(St.material.uniforms.uSunDirection.value.copy(Et),St.material.uniforms.uCameraPosition.value.copy(k.position))}function Vl(o){const e=o.params.eccentricity,t=[],i=360,n=o.currentRAAN,s=o.params.argPerigeeRad;for(let r=0;r<=i;r++){const a=r/i*2*Math.PI,l={semiMajorAxis:o.params.semiMajorAxis,eccentricity:o.params.eccentricity,inclinationRad:o.params.inclinationRad,argPerigeeRad:s},c=zr(l,it(tt(a,e),e),n,X);t.push(new R(c.x,c.y,c.z))}o.orbitalPath3DPoints=t,o.orbitLine&&(L.remove(o.orbitLine),o.orbitLine.geometry.dispose(),o.orbitLine.material.dispose()),o.orbitLine=new vi(new ai().setFromPoints(t),new Ei({color:65280})),L.add(o.orbitLine)}function Hl(o){o.coverageCone&&(L.remove(o.coverageCone),o.coverageCone.geometry.dispose(),o.coverageCone.material.dispose(),o.coverageCone=null),o.coverageRing&&(L.remove(o.coverageRing),o.coverageRing.geometry.dispose(),o.coverageRing.material.dispose(),o.coverageRing=null);const e=o.params.beamwidth;if(e<=0||e>=180)return;const t=X,i=o.mesh.position.clone(),n=i.length();if(n<=t)return;const s=Ye.degToRad(e/2);let r=Math.asin(Math.min(1,n/t*Math.sin(s)))-s;const a=Math.acos(t/n);if(r<0||r>a){if(s<a)return;r=a}o.coverageAngleRad=r;const l=n-t*Math.cos(r),c=t*Math.sin(r);if(l<=0||c<=0)return;const h=new So(c,l,256,1,!0);h.translate(0,-l/2,0);const u=new He({color:65535,transparent:!0,opacity:.2,side:Ls}),d=new ut(h,u);d.position.copy(i);const p=i.clone().negate().normalize(),m=new Jt().setFromUnitVectors(new R(0,-1,0),p);d.setRotationFromQuaternion(m),L.add(d),o.coverageCone=d}function Bl(o){o.nadirLine&&(L.remove(o.nadirLine),o.nadirLine.geometry.dispose(),o.nadirLine.material.dispose());const e=o.mesh.position,t=e.clone().normalize().multiplyScalar(X),i=[e,t];o.nadirLine=new vi(new ai().setFromPoints(i),new Ei({color:8947848,linewidth:2})),o.nadirLine.visible=window.nadirLinesEnabled,L.add(o.nadirLine)}function Kl(){if(window.gsSatLinkLines.forEach(n=>{n&&n.parent&&(L.remove(n),n.geometry&&n.geometry.dispose(),n.material&&n.material.dispose())}),window.gsSatLinkLines.clear(),!window.activeGroundStations||window.activeGroundStations.size===0||!window.activeSatellites||window.activeSatellites.size===0)return;const o=new R,e=new R,t=new R,i=new R;window.activeGroundStations.forEach(n=>{if(!(!n||!n.mesh||!n.mesh.position)){try{n.mesh.getWorldPosition(o)}catch{return}window.activeSatellites.forEach(s=>{if(!s||!s.mesh||!s.mesh.position||!s.params||typeof s.params.beamwidth!="number")return;try{s.mesh.getWorldPosition(e)}catch{return}const r=`${n.id}|${s.id}`,a=Ye.degToRad(s.params.beamwidth/2);t.copy(o).sub(e).normalize(),i.copy(e).negate().normalize();const l=Ye.acosSafe(i.dot(t))<=a,c=o.clone().normalize(),h=e.clone().normalize(),d=Ye.acosSafe(c.dot(h))<=s.coverageAngleRad;if(l&&d){let p=window.gsSatLinkLines.get(r);p?p.geometry.setFromPoints([o,e]):(p=new vi(new ai().setFromPoints([o,e]),new Ei({color:16776960,linewidth:1})),L.add(p),window.gsSatLinkLines.set(r,p))}})}})}Ye.acosSafe=function(o){return Math.acos(Ye.clamp(o,-1,1))};class Xl{constructor(e,t,i,n,s,r){this.id=e,this.name=t,this.params={...i},this.initialEpochUTC=r,this.initialMeanAnomaly=n,this.currentMeanAnomaly=n,this.currentRAAN=s,this.initialRAAN=s,this.initialArgPerigee=this.params.argPerigeeRad,this.currentArgPerigee=this.params.argPerigeeRad,this.latitudeDeg=0,this.longitudeDeg=0;const a=(window.currentEpochUTC-r)/1e3;a!==0&&(xs(this,a),this.initialMeanAnomaly=this.currentMeanAnomaly,this.initialRAAN=this.currentRAAN,this.initialArgPerigee=this.currentArgPerigee),this.currentTrueAnomaly=Qe(Ze(this.currentMeanAnomaly,this.params.eccentricity),this.params.eccentricity),this.sphereMesh=null,this.glbMesh=null,this.mesh=null,this.orbitLine=null,this.coverageCone=null,this.nadirLine=null,this.prevPosition=new R,this.velocity=new R,this.orbitalVelocityMagnitude=0,this.orbitalPath3DPoints=[],this.groundTrackHistory=[],this.maxGroundTrackPoints=300,this.isCloseView=!1,this.createMeshes(),this.updatePosition(window.totalSimulatedTime,0)}createMeshes(){const e=new qt(.005,16,16),t=new He({color:255});this.sphereMesh=new ut(e,t),L.add(this.sphereMesh),Si&&Fe&&this.setGlbMesh(Fe),this.mesh=this.sphereMesh,this.mesh.visible=!0}updatePosition(e,t){this.prevPosition.copy(this.mesh.position);const n=(window.currentEpochUTC+e*1e3-this.initialEpochUTC)/1e3;xs(this,n);const s=Ze(this.currentMeanAnomaly,this.params.eccentricity);this.currentTrueAnomaly=Qe(s,this.params.eccentricity);const{x:r,y:a,z:l}=zr(this.params,this.currentMeanAnomaly,this.currentRAAN,X),c=new R(r,a,l);if(this.mesh.position.copy(c),this.glbMesh&&this.glbMesh.visible){this.glbMesh.position.copy(this.mesh.position);const f=this.mesh.position.clone().negate().normalize(),_=this.velocity.clone().normalize();_.length()<.1&&_.set(1,0,0);const g=new Se;g.lookAt(new R(0,0,0),f,_),this.glbMesh.setRotationFromMatrix(g),this.glbMesh.rotateX(Math.PI/2)}t>0?(this.velocity.copy(this.mesh.position).sub(this.prevPosition).divideScalar(t),this.orbitalVelocityMagnitude=this.velocity.length()*(Y/X)):this.orbitalVelocityMagnitude=0;const h=wt.peekRotationAngle(window.totalSimulatedTime),u=this.mesh.position.clone().applyAxisAngle(new R(0,1,0),-h),d=u.length(),p=Math.asin(u.y/d);let m=Math.atan2(-u.z,u.x);this.latitudeDeg=p*(180/Math.PI),this.longitudeDeg=m*(180/Math.PI),this.groundTrackHistory.push({lat:this.latitudeDeg,lon:this.longitudeDeg}),this.groundTrackHistory.length>this.maxGroundTrackPoints&&this.groundTrackHistory.shift(),Hl(this),Bl(this),Vl(this)}setGlbMesh(e){if(!this.glbMesh){this.glbMesh=e.clone(),this.glbMesh.scale.set(2e-6,2e-6,2e-6);const t=new vs(16777215,1,X*.1);t.position.set(0,50,0),this.glbMesh.add(t);const i=new Ns(16777215,.3);this.glbMesh.add(i),this.glbMesh.traverse(n=>{n.isMesh&&n.material&&(n.material.emissive=new Ee(4473924),n.material.emissiveIntensity=.1)}),this.glbMesh.visible=!1,L.add(this.glbMesh)}}setActiveMesh(e){e&&this.glbMesh?(this.mesh=this.glbMesh,this.sphereMesh.visible=!1,this.glbMesh.visible=!0):(this.mesh=this.sphereMesh,this.sphereMesh.visible=!0,this.glbMesh&&(this.glbMesh.visible=!1))}dispose(){if(window.gsSatLinkLines){const e=[];window.gsSatLinkLines.forEach((t,i)=>{(i.startsWith(this.id+"|")||i.endsWith("|"+this.id))&&(L.remove(t),t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose(),e.push(i))}),e.forEach(t=>window.gsSatLinkLines.delete(t))}this.sphereMesh&&(L.remove(this.sphereMesh),this.sphereMesh.geometry&&this.sphereMesh.geometry.dispose(),this.sphereMesh.material&&this.sphereMesh.material.dispose(),this.sphereMesh=null),this.glbMesh&&(L.remove(this.glbMesh),this.glbMesh.traverse(e=>{e.isMesh&&(e.geometry&&e.geometry.dispose(),e.material&&(e.material.isMaterial?e.material.dispose():Array.isArray(e.material)&&e.material.forEach(t=>t.dispose())))}),this.glbMesh=null),this.orbitLine&&(L.remove(this.orbitLine),this.orbitLine.geometry&&this.orbitLine.geometry.dispose(),this.orbitLine.material&&this.orbitLine.material.dispose(),this.orbitLine=null),this.coverageCone&&(L.remove(this.coverageCone),this.coverageCone.geometry&&this.coverageCone.geometry.dispose(),this.coverageCone.material&&this.coverageCone.material.dispose(),this.coverageCone=null),this.nadirLine&&(L.remove(this.nadirLine),this.nadirLine.geometry&&this.nadirLine.geometry.dispose(),this.nadirLine.material&&this.nadirLine.material.dispose(),this.nadirLine=null),this.labelObject&&(this.mesh&&this.mesh.remove(this.labelObject),this.labelObject=null),this._labelElement&&(this._labelElement.remove(),this._labelElement=null),this.mesh=null}updateParametersFromCurrentPosition(e,t){const i=Ze(this.currentMeanAnomaly,this.params.eccentricity),n=Qe(i,this.params.eccentricity);this.params={...e},this.initialEpochUTC=t;const s=tt(n,this.params.eccentricity);this.initialMeanAnomaly=it(s,this.params.eccentricity),this.initialMeanAnomaly%=2*Math.PI,this.initialMeanAnomaly<0&&(this.initialMeanAnomaly+=2*Math.PI),this.initialRAAN=e.raanRad,this.currentRAAN=this.initialRAAN,this.updatePosition(window.totalSimulatedTime,0)}updateTrueAnomalyOnly(e){const t=tt(e,this.params.eccentricity);this.currentMeanAnomaly=it(t,this.params.eccentricity),this.currentMeanAnomaly%=2*Math.PI,this.currentMeanAnomaly<0&&(this.currentMeanAnomaly+=2*Math.PI),this.initialMeanAnomaly=this.currentMeanAnomaly,this.updatePosition(window.totalSimulatedTime,0)}}function Wl(o){const e=document.createElement("div");e.className="satellite-label",e.textContent=o.name,e.style.color="white",e.style.fontSize="12px",e.style.whiteSpace="nowrap",e.style.textAlign="center";const t=new zs(e);t.position.set(0,.05,0),t.visible=window.labelVisibilityEnabled,o.labelObject=t,o.mesh.add(t),o._labelElement=e,window.labelVisibilityManager&&window.labelVisibilityManager.updateLabelVisibility()}window.highlightSatelliteInScene=function(o){window.activeSatellites.forEach(e=>{if(e.sphereMesh){const t=e.sphereMesh.material;t.color.setHex(e.id===o?65280:255),t.emissive&&t.emissive.setHex(e.id===o?65280:0)}e._labelElement&&(e._labelElement.style.color=e.id===o?"limegreen":"white"),e.id===o&&window.closeViewEnabled&&e.labelObject?(e.labelObject.visible=!0,e._labelElement&&(e._labelElement.style.fontSize="16px",e._labelElement.style.fontWeight="bold",e._labelElement.style.backgroundColor="rgba(0, 0, 0, 0.7)",e._labelElement.style.padding="4px 8px",e._labelElement.style.borderRadius="4px",e._labelElement.style.border="1px solid limegreen")):e._labelElement&&(e._labelElement.style.fontSize="12px",e._labelElement.style.fontWeight="normal",e._labelElement.style.backgroundColor="transparent",e._labelElement.style.padding="0",e._labelElement.style.border="none")})};class Yl{constructor(){this.globalVisible=!0,this.proximityMode=!1,this.proximityDistance=2,this.maxLabels=10,this.nadirLinesVisible=!0}setNadirLinesVisibility(e){this.nadirLinesVisible=e,window.nadirLinesEnabled=e,this.updateNadirLinesVisibility()}updateNadirLinesVisibility(){window.activeSatellites.forEach(e=>{e.nadirLine&&(e.nadirLine.visible=this.nadirLinesVisible)})}updateLabelVisibility(){if(!this.globalVisible){this.hideAllLabels();return}this.proximityMode?this.updateProximityLabels():this.showAllLabels(),this.updateNadirLinesVisibility()}hideAllLabels(){window.activeSatellites.forEach(e=>{e.labelObject&&(e.labelObject.visible=!1)}),window.activeGroundStations.forEach(e=>{e.labelObject&&(e.labelObject.visible=!1)})}showAllLabels(){window.activeSatellites.forEach(e=>{e.labelObject&&(e.labelObject.visible=!0)}),window.activeGroundStations.forEach(e=>{e.labelObject&&(e.labelObject.visible=!0)})}updateProximityLabels(){const e=k.position,t=Array.from(window.activeSatellites.values()).map(n=>({satellite:n,distance:e.distanceTo(n.mesh.position)})).sort((n,s)=>n.distance-s.distance);this.hideAllLabels();let i=0;for(const n of t){if(window.closeViewEnabled&&n.satellite.id===window.selectedSatelliteId){n.satellite.labelObject&&(n.satellite.labelObject.visible=!0);continue}n.distance<=this.proximityDistance&&i<this.maxLabels&&n.satellite.labelObject&&(n.satellite.labelObject.visible=!0,i++)}window.activeGroundStations.forEach(n=>{n.labelObject&&(n.labelObject.visible=!0)})}setGlobalVisibility(e){this.globalVisible=e,window.labelVisibilityEnabled=e,this.updateLabelVisibility()}setProximityMode(e,t=2,i=10){this.proximityMode=e,this.proximityDistance=t,this.maxLabels=i,window.proximityLabelsEnabled=e,window.labelProximityDistance=t,window.maxVisibleLabels=i,this.updateLabelVisibility()}}const Gt=new Yl;window.labelVisibilityManager=Gt;window.toggleLabels=function(){Gt.setGlobalVisibility(!window.labelVisibilityEnabled)};window.toggleProximityLabels=function(){Gt.setProximityMode(!window.proximityLabelsEnabled,window.labelProximityDistance,window.maxVisibleLabels)};window.configureLabelProximity=function(o,e){window.labelProximityDistance=o,window.maxVisibleLabels=e,window.proximityLabelsEnabled&&Gt.setProximityMode(!0,o,e)};window.toggleNadirLines=function(){Gt.setNadirLinesVisibility(!window.nadirLinesEnabled),updateNadirButtonStates()};window.highlightGroundStationInScene=function(o){window.activeGroundStations.forEach(e=>{e.mesh&&(e.mesh.material.color.setHex(e.id===o?65535:16776960),e.mesh.material.emissive.setHex(e.id===o?65535:0)),e._labelElement&&(e._labelElement.style.color=e.id===o?"cyan":"white")})};function Gr(o){const e=document.createElement("div");e.className="satellite-label",e.textContent=o.name,e.style.color="white",e.style.fontSize="12px",e.style.whiteSpace="nowrap";const t=new zs(e);t.position.set(0,.02,0),t.visible=window.labelVisibilityEnabled,o.labelObject=t,o.mesh.add(t),o._labelElement=e,window.labelVisibilityManager&&window.labelVisibilityManager.updateLabelVisibility()}window.refreshAllLabels=function(){window.labelVisibilityManager&&window.labelVisibilityManager.updateLabelVisibility()};class ql{constructor(e,t,i,n){this.id=e,this.name=t,this.latitude=i,this.longitude=n,this.mesh=null,this.coverageCone=null,this._labelElement=null,this.createMesh()}createMesh(){const e=X,t=this.latitude*Q,i=-this.longitude*Q,n=e*Math.cos(t)*Math.cos(i),s=e*Math.sin(t),r=e*Math.cos(t)*Math.sin(i),a=new qt(.005,16,16),l=new He({color:16776960});this.mesh=new ut(a,l),this.mesh.name=`groundstation-${this.id}-${this.name}`,this.mesh.position.set(n,s,r),Re.add(this.mesh),Gr(this)}dispose(){if(window.gsSatLinkLines){const e=[];window.gsSatLinkLines.forEach((t,i)=>{(i.startsWith(this.id+"|")||i.endsWith("|"+this.id))&&(L.remove(t),t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose(),e.push(i))}),e.forEach(t=>window.gsSatLinkLines.delete(t))}this.mesh&&(Re&&Re.children.includes(this.mesh)&&Re.remove(this.mesh),this.mesh.geometry&&this.mesh.geometry.dispose(),this.mesh.material&&this.mesh.material.dispose(),this.mesh=null),this.labelObject&&(this.mesh&&this.mesh.remove(this.labelObject),this.labelObject=null),this._labelElement&&(this._labelElement.remove(),this._labelElement=null)}}function $l(){if(Fe)return Promise.resolve(Fe);const o=new jo,e=document.getElementById("loading-message");return e&&(e.style.display="block"),new Promise((t,i)=>{o.load("/Satellitemodel/CALIPSO.glb",n=>{Fe=n.scene,Si=!0,e&&(e.style.display="none"),window.activeSatellites.forEach(s=>s.setGlbMesh(Fe)),window.activeSatellites.forEach(s=>s.setActiveMesh(window.closeViewEnabled)),t(Fe)},n=>{n.total>0&&e&&(e.innerText=`Loading satellite model... ${Math.round(n.loaded/n.total*100)}%`)},n=>{console.error("Error loading GLB model:",n),e&&(e.innerText="Error loading satellite model. Using spheres."),Si=!1,i(n)})})}jl();wt.initialize(window.currentEpochUTC);zt(window.totalSimulatedTime);Z.render(L,k);$l().catch(()=>console.warn("GLB model failed to load, proceeding with sphere models."));window.clearSimulationScene=function(){window.activeSatellites.forEach(o=>o.dispose()),window.activeSatellites.clear(),window.activeGroundStations.forEach(o=>o.dispose()),window.activeGroundStations.clear(),window.selectedSatelliteId=null,window.selectedGroundStationId=null,window.closeViewEnabled=!1,A.object.up.set(0,1,0),A.minDistance=1.2,A.maxDistance=10,A.target.set(0,0,0),k.position.set(0,0,2.5),A.update(),window.isAnimating=!1,window.totalSimulatedTime=0,window.currentSpeedMultiplier=1,Ut&&(Ut.rotation.y=0),wt.initialize(window.currentEpochUTC),zt(0),Z.render(L,k),typeof window.updateAnimationDisplay=="function"&&window.updateAnimationDisplay(),window.gsSatLinkLines.forEach(o=>{L.remove(o),o.geometry.dispose(),o.material.dispose()}),window.gsSatLinkLines.clear(),window.highlightSatelliteInScene(null),window.highlightGroundStationInScene(null)};window.addOrUpdateSatelliteInScene=function(o){const e=o.id||o.fileName;if(!e){console.error("Satellite data missing unique ID or fileName.");return}let t=window.activeSatellites.get(e);const i=typeof o.utcTimestamp=="number"?o.utcTimestamp:window.currentEpochUTC;let n;const s=o.altitude,r=o.eccentricity;r<1e-4?n=(Y+s)/(Y/X):n=(Y+s)/(1-r)/(Y/X);const a={altitude:o.altitude,semiMajorAxis:n,inclinationRad:o.inclination*Q,eccentricity:o.eccentricity,raan:o.raan*Q,argPerigeeRad:o.argumentOfPerigee*Q,beamwidth:o.beamwidth};if(t)t.updateParametersFromCurrentPosition(a,i),t.name=o.name||e;else{const c=new Xl(e,o.name||e,a,o.trueAnomaly?it(tt(o.trueAnomaly*Q,o.eccentricity),o.eccentricity):0,o.raan*Q,i);Si&&Fe&&c.setGlbMesh(Fe),c.setActiveMesh(window.closeViewEnabled),window.activeSatellites.set(c.id,c)}const l=t||window.activeSatellites.get(e);l&&(l._labelElement?l._labelElement.textContent=l.name:Wl(l),l.setActiveMesh(window.closeViewEnabled)),window.is2DViewActive&&window.texturesLoaded&&window.dispatchEvent(new Event("epochUpdated"))};window.addOrUpdateGroundStationInScene=function(o){const e=o.id||o.name;if(!e)return;let t=window.activeGroundStations.get(e);t&&(t.dispose(),window.activeGroundStations.delete(e));const i=new ql(e,o.name||e,o.latitude,o.longitude);if(window.activeGroundStations.set(i.id,i),i._labelElement||Gr(i),window.activeSatellites.size===0&&window.activeGroundStations.size===1){const n=i.mesh.position;k.position.set(n.x*2,n.y*2,n.z*2+1),A.target.copy(n),A.update()}typeof window.updateAnimationDisplay=="function"&&window.updateAnimationDisplay(),Z.render(L,k)};window.viewSimulation=function(o){if(window.clearSimulationScene(),typeof o.utcTimestamp=="number"?(window.currentEpochUTC=o.utcTimestamp,window.totalSimulatedTime=0):(window.currentEpochUTC=Date.now(),window.totalSimulatedTime=0),wt.initialize(window.currentEpochUTC),o.fileType==="single")window.addOrUpdateSatelliteInScene({id:o.fileName,name:o.fileName,altitude:o.altitude,inclination:o.inclination,eccentricity:o.eccentricity,raan:o.raan,argumentOfPerigee:o.argumentOfPerigee,trueAnomaly:o.trueAnomaly,utcTimestamp:window.currentEpochUTC,beamwidth:o.beamwidth}),window.isAnimating=!1,o.satellites=[o.fileName],window.fileOutputs.set(o.fileName,o),window.saveFilesToLocalStorage&&window.saveFilesToLocalStorage(),window.updateOutputTabForFile(o.fileName,o.fileType);else if(o.fileType==="constellation"){const e=o,t=[],i={altitude:e.altitude,inclination:e.inclination,eccentricity:e.eccentricity,raan:e.raan,argumentOfPerigee:e.argumentOfPerigee,trueAnomaly:e.trueAnomaly,beamwidth:e.beamwidth};if(e.constellationType==="train"){const n=e.numSatellites,s=e.separationType,r=e.separationValue,a=e.trainDirection==="backward",c=Oi(i.altitude,i.eccentricity,Y).orbitalPeriod;let h=0;s==="meanAnomaly"?h=r*Q:h=2*Math.PI/c*r,a&&(h*=-1);let u=it(tt(i.trueAnomaly*Q,i.eccentricity),i.eccentricity);for(let d=0;d<n;d++){const p=((u+d*h)%(2*Math.PI)+2*Math.PI)%(2*Math.PI),m=Qe(Ze(p,i.eccentricity),i.eccentricity)*(180/Math.PI),f=`${o.fileName}-${Date.now()}-${d+1}`,_=`${o.fileName}_Sat${d+1}`;window.addOrUpdateSatelliteInScene({id:f,name:_,altitude:i.altitude,inclination:i.inclination,eccentricity:i.eccentricity,raan:i.raan,argumentOfPerigee:i.argumentOfPerigee,trueAnomaly:m,utcTimestamp:window.currentEpochUTC,beamwidth:i.beamwidth,fileType:o.fileType}),t.push(f),window.isAnimating=!1}}else if(e.constellationType==="walker"){const n=parseInt(e.numPlanes,10)||1,s=parseInt(e.satellitesPerPlane,10)||1,r=parseInt(e.phasingFactor,10)||0,l=(parseFloat(e.raanSpread)||360)/n*Q,c=2*Math.PI/s,h=r*(2*Math.PI)/(n*s);let u=it(tt(i.trueAnomaly*Q,i.eccentricity),i.eccentricity);for(let d=0;d<n;d++){const p=((i.raan*Q+d*l)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);for(let m=0;m<s;m++){let f=u+m*c+d*h;f=(f%(2*Math.PI)+2*Math.PI)%(2*Math.PI);const _=Qe(Ze(f,i.eccentricity),i.eccentricity)*(180/Math.PI),g=`${o.fileName}-${Date.now()}-${d+1}-${m+1}`,w=`${o.fileName}_Sat${d+1}_${m+1}`;window.addOrUpdateSatelliteInScene({id:g,name:w,altitude:i.altitude,inclination:i.inclination,eccentricity:i.eccentricity,raan:p*(180/Math.PI),argumentOfPerigee:i.argumentOfPerigee,trueAnomaly:_,utcTimestamp:window.currentEpochUTC,beamwidth:i.beamwidth,fileType:o.fileType}),t.push(g),window.isAnimating=!1}}}e.satellites=t,window.fileOutputs.set(o.fileName,e),window.saveFilesToLocalStorage&&window.saveFilesToLocalStorage(),window.updateOutputTabForFile(o.fileName,o.fileType)}else o.fileType==="groundStation"&&window.addOrUpdateGroundStationInScene(o);zt(window.totalSimulatedTime),Z.render(L,k),window.updateAnimationDisplay&&window.updateAnimationDisplay()};window.removeObjectFromScene=function(o,e){if(e==="satellite"){const t=window.activeSatellites.get(o);t&&(t.dispose(),window.activeSatellites.delete(o),window.fileOutputs.forEach((i,n)=>{i.satellites&&i.satellites.includes(o)&&(i.satellites=i.satellites.filter(s=>s!==o),window.fileOutputs.set(n,i),typeof window.saveFilesToLocalStorage=="function"&&window.saveFilesToLocalStorage(),window.updateOutputTabForFile(n,i.fileType))}),window.selectedSatelliteId===o&&(window.selectedSatelliteId=null,A.target.set(0,0,0),k.position.set(0,0,2.5),A.update(),window.closeViewEnabled=!1))}else if(e==="groundStation"){const t=window.activeGroundStations.get(o);t&&(t.dispose(),window.activeGroundStations.delete(o),window.selectedGroundStationId===o&&(window.selectedGroundStationId=null,A.target.set(0,0,0),k.position.set(0,0,2.5),A.update()))}typeof window.updateAnimationDisplay=="function"&&window.updateAnimationDisplay()};window.getSimulationCoreObjects=function(){return{scene:L,camera:k,renderer:Z,controls:A,earthGroup:Re,activeSatellites:window.activeSatellites,activeGroundStations:window.activeGroundStations,isAnimating:window.isAnimating,is2DViewActive:window.is2DViewActive,currentSpeedMultiplier:window.currentSpeedMultiplier,totalSimulatedTime:window.totalSimulatedTime,selectedSatelliteId:window.selectedSatelliteId,closeViewEnabled:window.closeViewEnabled,currentEpochUTC:window.currentEpochUTC,setTotalSimulatedTime:o=>{window.totalSimulatedTime=o},setIsAnimating:o=>{window.isAnimating=o},setCurrentSpeedMultiplier:o=>{window.currentSpeedMultiplier=o},setSelectedSatelliteId:o=>{window.selectedSatelliteId=o},setCloseViewEnabled:o=>{window.closeViewEnabled=o,window.activeSatellites.forEach(e=>e.setActiveMesh(o))},setCurrentEpochUTC:o=>{window.currentEpochUTC=o}}};function Zl(){if(typeof window.fileOutputs>"u"||typeof window.groundStations>"u"){console.error("Data maps (fileOutputs, groundStations) not found. Cannot load simulation state.");return}console.log("Loading 3D simulation state from pre-loaded file data..."),typeof window.clearSimulationScene=="function"&&window.clearSimulationScene();const o=window.fileOutputs.values().next().value;o&&typeof o.utcTimestamp=="number"?(window.currentEpochUTC=o.utcTimestamp,window.totalSimulatedTime=0):(window.currentEpochUTC=Date.now(),window.totalSimulatedTime=0),wt.initialize(window.currentEpochUTC),window.fileOutputs.forEach(e=>{if(e.fileType==="single")typeof window.addOrUpdateSatelliteInScene=="function"&&window.addOrUpdateSatelliteInScene(e);else if(e.fileType==="constellation"){const t=e,i={altitude:t.altitude,inclination:t.inclination,eccentricity:t.eccentricity,raan:t.raan,argumentOfPerigee:t.argumentOfPerigee,trueAnomaly:t.trueAnomaly,beamwidth:t.beamwidth};if(t.constellationType==="train"){const n=t.numSatellites,s=t.separationType,r=t.separationValue,a=t.trainDirection==="backward",c=Oi(i.altitude,i.eccentricity,Y).orbitalPeriod;let h=0;s==="meanAnomaly"?h=r*Q:h=2*Math.PI/c*r,a&&(h*=-1);let u=it(tt(i.trueAnomaly*Q,i.eccentricity),i.eccentricity);for(let d=0;d<n;d++){const p=((u+d*h)%(2*Math.PI)+2*Math.PI)%(2*Math.PI),m=Qe(Ze(p,i.eccentricity),i.eccentricity)*(180/Math.PI),f=`${e.fileName}-${Date.now()}-${d+1}`,_=`${e.fileName}_Sat${d+1}`;window.addOrUpdateSatelliteInScene({id:f,name:_,altitude:i.altitude,inclination:i.inclination,eccentricity:i.eccentricity,raan:i.raan,argumentOfPerigee:i.argumentOfPerigee,trueAnomaly:m,utcTimestamp:window.currentEpochUTC,beamwidth:i.beamwidth,fileType:e.fileType})}}else if(t.constellationType==="walker"){const n=parseInt(t.numPlanes,10)||1,s=parseInt(t.satellitesPerPlane,10)||1,r=parseInt(t.phasingFactor,10)||0,l=(parseFloat(t.raanSpread)||360)/n*Q,c=2*Math.PI/s,h=r*(2*Math.PI)/(n*s);let u=it(tt(i.trueAnomaly*Q,i.eccentricity),i.eccentricity);for(let d=0;d<n;d++){const p=((i.raan*Q+d*l)%(2*Math.PI)+2*Math.PI)%(2*Math.PI);for(let m=0;m<s;m++){let f=u+m*c+d*h;f=(f%(2*Math.PI)+2*Math.PI)%(2*Math.PI);const _=Qe(Ze(f,i.eccentricity),i.eccentricity)*(180/Math.PI),g=`${e.fileName}-${Date.now()}-${d+1}-${m+1}`,w=`${e.fileName}_Sat${d+1}_${m+1}`;window.addOrUpdateSatelliteInScene({id:g,name:w,altitude:i.altitude,inclination:i.inclination,eccentricity:i.eccentricity,raan:p*(180/Math.PI),argumentOfPerigee:i.argumentOfPerigee,trueAnomaly:_,utcTimestamp:window.currentEpochUTC,beamwidth:i.beamwidth,fileType:e.fileType})}}}}}),window.groundStations.forEach(e=>{typeof window.addOrUpdateGroundStationInScene=="function"&&window.addOrUpdateGroundStationInScene(e)}),zt(window.totalSimulatedTime),Z.render(L,k),typeof window.updateAnimationDisplay=="function"&&window.updateAnimationDisplay(),console.log("3D simulation state restored from file definitions.")}window.load3DSimulationState=Zl;function Wt(o){return(o*180/Math.PI).toFixed(2)}function jr(o){const e=Y;return(o.mesh.position.length()*e-e).toFixed(2)}window.toDeg=Wt;window.computeAltitude=jr;function Ql(){if(!window.activeSatellitePopup)return;const{element:o,satId:e}=window.activeSatellitePopup,t=window.activeSatellites.get(e);if(!t){o&&o.remove(),window.activeSatellitePopup=null;return}const n=t.params.semiMajorAxis*(Y/X),s=t.currentTrueAnomaly,{orbitalVelocity:r,orbitalPeriod:a}=Oi(n,t.params.eccentricity,s);o.querySelector(".altitude").textContent=jr(t),o.querySelector(".inclination").textContent=Wt(t.params.inclinationRad),o.querySelector(".latitude").textContent=t.latitudeDeg.toFixed(2),o.querySelector(".longitude").textContent=t.longitudeDeg.toFixed(2),o.querySelector(".raan").textContent=Wt(t.currentRAAN),o.querySelector(".orbitalPeriod").textContent=(a/60).toFixed(2),o.querySelector(".orbitalVelocity").textContent=r.toFixed(2),o.querySelector(".beamwidth").textContent=t.params.beamwidth,o.querySelector(".trueAnomaly").textContent=Wt(t.currentTrueAnomaly),o.querySelector(".eccentricity").textContent=t.params.eccentricity.toFixed(4),o.querySelector(".argPerigee").textContent=Wt(t.params.argPerigeeRad)}window.updateSatellitePopup=Ql;window.generateConstellationFromLinkBudget=function(o){const t={fileName:`${o.name}_Constellation`,fileType:"constellation",constellationType:"walker",altitude:o.altitude,inclination:o.inclination,beamwidth:o.beamwidth,eccentricity:0,raan:0,argumentOfPerigee:0,trueAnomaly:0,numPlanes:o.numOrbitalPlanes,satellitesPerPlane:o.satsPerPlane,raanSpread:o.raanSpread||360,phasingFactor:o.phasingFactor||1,epoch:new Date().toISOString().slice(0,16),utcTimestamp:Date.now(),satellites:[]};window.viewSimulation(t)};function Vr(){requestAnimationFrame(Vr);const o=performance.now(),e=(o-Ms)/1e3;Ms=o;const t=window.getSimulationCoreObjects();t.isAnimating&&(t.setTotalSimulatedTime(t.totalSimulatedTime+e*t.currentSpeedMultiplier),Ut&&(Ut.rotation.y+=.05*_i*e),t.activeSatellites.forEach(i=>i.updatePosition(t.totalSimulatedTime,e))),Re.rotation.y=wt.getRotationAngle(t.totalSimulatedTime),zt(t.totalSimulatedTime),We.material.uniforms&&(We.material.uniforms.uTime.value=t.totalSimulatedTime),window.dispatchEvent(new Event("epochUpdated")),Z.render(L,k),labelRenderer.render(L,k),window.proximityLabelsEnabled&&Gt.updateProximityLabels(),t.is2DViewActive&&typeof window.draw2D=="function"&&window.draw2D(),window.updateSatellitePopup&&window.updateSatellitePopup(),typeof window.updateAnimationDisplay=="function"&&window.updateAnimationDisplay();try{Kl()}catch(i){console.error("Error in updateGsSatLinkLines:",i)}if(t.closeViewEnabled&&t.selectedSatelliteId){const i=t.activeSatellites.get(t.selectedSatelliteId);if(i){const n=i.mesh.position.clone(),s=i.velocity.length()>0?i.velocity.clone().normalize():new R(0,0,1),r=n.clone().normalize(),a=s.clone().multiplyScalar(-1*.08).add(r.clone().multiplyScalar(X*.04)),l=n.clone().add(a);window.gsapAnimating||(A.enabled=!0);const c=X*.001;if(k.position.distanceTo(l)>c&&(window.gsapAnimating=!0,pn.to(k.position,{duration:.15,x:l.x,y:l.y,z:l.z,ease:"none",onUpdate:()=>A.update(),onComplete:()=>{window.gsapAnimating=!1,A.enabled=!0}}),pn.to(A.target,{duration:.15,x:n.x,y:n.y,z:n.z,ease:"none",onUpdate:()=>A.update()})),A.object.up.copy(r),A.update(),A.minDistance=X*.01,A.maxDistance=X*.2,i.labelObject){i.labelObject.visible=!0;const h=k.position.distanceTo(i.mesh.position),u=Math.max(.05,Math.min(.1,h*.1));i.labelObject.position.set(0,u,0)}}}else t.closeViewEnabled||(window.gsapAnimating=!1,A.enabled=!0,(A.minDistance!==1.2||A.maxDistance!==10||A.object.up.y!==1)&&(A.object.up.set(0,1,0),A.minDistance=1.2,A.maxDistance=10,A.update()))}Vr();window.addEventListener("resize",()=>{const o=document.getElementById("earth-container");if(o&&k&&Z){const e=o.offsetWidth,t=o.offsetHeight;Z.setSize(e,t),labelRenderer.setSize(e,t),k.aspect=e/t,k.updateProjectionMatrix(),A.update()}});
